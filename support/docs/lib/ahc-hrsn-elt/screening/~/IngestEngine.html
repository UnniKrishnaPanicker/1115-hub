<!DOCTYPE html>
<html>
<head>
  <title>IngestEngine - AHC HRSN Screening  documentation</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="doc-current-file" content="">
  <link rel="stylesheet" href="../../styles.css">
  <link rel="stylesheet" href="../../page.css">
</head>
<body>


<nav id="sidepanel">
    
      <h2><a href="index.html"><span>AHC HRSN Screening</span></a></h2>
    
    
        <h3>Class</h3>
        <ul>
          
            <li>
              <a href="../.././/~/ExcelSheetTodoIngestSource.html">
                <div class="symbol_kind kind_Class_text kind_Class_bg" title="Class">
  c
</div>

                <span>ExcelSheetTodoIngestSource</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/IngestEngine.html">
                <div class="symbol_kind kind_Class_text kind_Class_bg" title="Class">
  c
</div>

                <span>IngestEngine</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ScreeningAssuranceRules.html">
                <div class="symbol_kind kind_Class_text kind_Class_bg" title="Class">
  c
</div>

                <span>ScreeningAssuranceRules</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ScreeningCsvFileIngestSource.html">
                <div class="symbol_kind kind_Class_text kind_Class_bg" title="Class">
  c
</div>

                <span>ScreeningCsvFileIngestSource</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ScreeningExcelSheetIngestSource.html">
                <div class="symbol_kind kind_Class_text kind_Class_bg" title="Class">
  c
</div>

                <span>ScreeningExcelSheetIngestSource</span>
              </a>
            </li>
        
        </ul>
    
        <h3>Function</h3>
        <ul>
          
            <li>
              <a href="../.././/~/fsPatternIngestSourcesSupplier.html">
                <div class="symbol_kind kind_Function_text kind_Function_bg" title="Function">
  f
</div>

                <span>fsPatternIngestSourcesSupplier</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ingestCsvFilesSourcesSupplier.html">
                <div class="symbol_kind kind_Function_text kind_Function_bg" title="Function">
  f
</div>

                <span>ingestCsvFilesSourcesSupplier</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ingestExcelSourcesSupplier.html">
                <div class="symbol_kind kind_Function_text kind_Function_bg" title="Function">
  f
</div>

                <span>ingestExcelSourcesSupplier</span>
              </a>
            </li>
        
        </ul>
    
        <h3>Interface</h3>
        <ul>
          
            <li>
              <a href="../.././/~/IngestEngineArgs.html">
                <div class="symbol_kind kind_Interface_text kind_Interface_bg" title="Interface">
  I
</div>

                <span>IngestEngineArgs</span>
              </a>
            </li>
        
        </ul>
    
        <h3>Type Alias</h3>
        <ul>
          
            <li>
              <a href="../.././/~/ExcelWorkbookSheetName.html">
                <div class="symbol_kind kind_TypeAlias_text kind_TypeAlias_bg" title="Type Alias">
  T
</div>

                <span>ExcelWorkbookSheetName</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/IngestStep.html">
                <div class="symbol_kind kind_TypeAlias_text kind_TypeAlias_bg" title="Type Alias">
  T
</div>

                <span>IngestStep</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/IngestStepContext.html">
                <div class="symbol_kind kind_TypeAlias_text kind_TypeAlias_bg" title="Type Alias">
  T
</div>

                <span>IngestStepContext</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/PotentialIngestSource.html">
                <div class="symbol_kind kind_TypeAlias_text kind_TypeAlias_bg" title="Type Alias">
  T
</div>

                <span>PotentialIngestSource</span>
              </a>
            </li>
        
        </ul>
    
        <h3>Variable</h3>
        <ul>
          
            <li>
              <a href="../.././/~/excelWorkbookSheetNames.html">
                <div class="symbol_kind kind_Variable_text kind_Variable_bg" title="Variable">
  v
</div>

                <span>excelWorkbookSheetNames</span>
              </a>
            </li>
        
            <li>
              <a href="../.././/~/ieDescr.html">
                <div class="symbol_kind kind_Variable_text kind_Variable_bg" title="Variable">
  v
</div>

                <span>ieDescr</span>
              </a>
            </li>
        
        </ul>
    
</nav>


<div id="content" class="with_sidepanel">
  <a href="./index.html">&#8592; Back to index</a>
  <input type="text" id="searchbar" style="display: none;" />

  <main class="symbol_group" id="symbol_IngestEngine">
  
    <article class="symbol">
      <div class="symbol_header">
        <div class="doc_block_title">
          <div>
            <span class="kind_Class_text">class</span>&nbsp;<span style="font-weight: 700;">IngestEngine</span>
          </div>
          <div class="doc_block_subtitle">
  
    
    
    
  

  
</div>
        </div>
      </div>
      <div>
        <div class="doc_block_items"><div class="markdown"><p>Use IngestEngine to prepare SQL for ingestion steps and execute them
using DuckDB CLI engine. Each method that does not have a @ieDescr.disregard()
attribute is considered a &quot;step&quot; and each step is executed in the order it is
declared. As each step is executed, its error or results are passed to the
next method.</p>
<p>This Engine assumes that the Kernel observer will abort on Errors. If you want
to continue after an error, throw a IngestResumableError and use the second
cell argument (result) to test for it.</p>
<p>This class is introspected and run using SQLa's Notebook infrastructure.
See: <a href="https://github.com/netspective-labs/sql-aide/tree/main/lib/notebook">https://github.com/netspective-labs/sql-aide/tree/main/lib/notebook</a></p>
</div><div>
  Constructors
  <div class="section">
    <div class="doc_item" id="constructor_0">
  
<a
    href="#constructor_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">IngestEngine</span><span style="font-weight: 500;">()</span>
    </code>
    </span>
  </div>
  
</div>

  </div>
</div><div>
  Properties
  <div class="section">
    <div class="doc_item" id="property_duckdb">
  
<a
    href="#property_duckdb"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">duckdb</span><span style="font-weight: 500;">: <span>ddbs.DuckDbShell</span></span>
    </code>
    </span>
  </div>
  
</div>
<div class="doc_item" id="property_ingestables">
  
<a
    href="#property_ingestables"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">ingestables</span><span style="font-weight: 500;">: { <span>readonly </span>psIndex: <span>number</span>; <span>readonly </span>source: <a href="../.././/~/PotentialIngestSource.html" class="link">PotentialIngestSource</a>; <span>readonly </span>workflow: <span>ReturnType</span>&lt;<a href="../.././/~/PotentialIngestSource.html" class="link">PotentialIngestSource</a>[<span>"workflow"</span>]&gt;; <span>readonly </span>sessionEntryID: <span>string</span>; <span>readonly </span>sql: <span>string</span>; <span>readonly </span>issues: { <span>readonly </span>session_entry_id: <span>string</span>; <span>readonly </span>ingest_session_issue_id: <span>string</span>; <span>readonly </span>issue_type: <span>string</span>; <span>readonly </span>issue_message: <span>string</span>; <span>readonly </span>invalid_value: <span>string</span>;  }[];  }[]</span>
    </code>
    </span>
  </div>
  
</div>
<div class="doc_item" id="property_potentialSources">
  
<a
    href="#property_potentialSources"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">potentialSources</span><span style="font-weight: 500;">: <a href="../.././/~/PotentialIngestSource.html" class="link">PotentialIngestSource</a>[]</span>
    </code>
    </span>
  </div>
  
</div>

  </div>
</div><div>
  Methods
  <div class="section">
    <div class="doc_item" id="method_emitDiagnostics_0">
  
<a
    href="#method_emitDiagnostics_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">emitDiagnostics</span><span style="font-weight: 500;">(): <span>Promise</span>&lt;<span>void</span>&gt;</span>
    </code>
    </span>
  </div>
  
</div>
<div class="doc_item" id="method_emitResources_0">
  
<a
    href="#method_emitResources_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">emitResources</span><span style="font-weight: 500;">(<span><span>isc<span>: <a href="../.././/~/IngestStepContext.html" class="link">IngestStepContext</a></span></span></span>): <span>Promise</span>&lt;<span>void</span>&gt;</span>
    </code>
    </span>
  </div>
  
</div>
<div class="doc_item" id="method_ensureContent_0">
  
<a
    href="#method_ensureContent_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">ensureContent</span><span style="font-weight: 500;">(<span><span>isc<span>: <a href="../.././/~/IngestStepContext.html" class="link">IngestStepContext</a></span></span><span>, </span><span>ingestResult<span>: <span>Awaited</span>&lt;<span>ReturnType</span>&lt;IngestEngine.prototype.ingest&gt;&gt;</span></span></span>): <span>Promise</span>&lt;<span>void</span>&gt;</span>
    </code>
    </span>
  </div>
  <div class="markdown"><p>For all ingestions from the previous step that did not create any issues
(meaning they were successfully ingested), prepare all cleansing,
validation, transformation and other SQL and then execute entire SQL as a
single DuckDB instance call.</p>
</div>
</div>
<div class="doc_item" id="method_ingest_0">
  
<a
    href="#method_ingest_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">ingest</span><span style="font-weight: 500;">(<span><span>isc<span>: <a href="../.././/~/IngestStepContext.html" class="link">IngestStepContext</a></span></span></span>)</span>
    </code>
    </span>
  </div>
  <div class="markdown"><p>Walk the root paths, find all types of files we can handle, generate
ingestion SQL (&quot;loading&quot; part of ELT/ETL) and execute the SQL in a single
DuckDB call. Then, for each successful execution (any ingestions that do
not create issues in the issue table) prepare the list of subsequent steps
for further cleansing, validation, transformations, etc.</p>
</div>
</div>
<div class="doc_item" id="method_init_0">
  
<a
    href="#method_init_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">init</span><span style="font-weight: 500;">(<span><span>isc<span>: <a href="../.././/~/IngestStepContext.html" class="link">IngestStepContext</a></span></span></span>): <span>Promise</span>&lt;<span>void</span>&gt;</span>
    </code>
    </span>
  </div>
  <div class="markdown"><p>Initialize the DuckDB database by ensuring the admin tables such as tracking
ingestion events (states), activities (which files are being loaded), ingest
issues (errors, etc.), and related  entities are created. If there are any
errors during this process all other processing should stop and no other steps
are executed.</p>
</div>
</div>
<div class="doc_item" id="method_prepareInit_0">
  
<a
    href="#method_prepareInit_0"
    class="anchor"
    aria-label="Anchor"
    tabIndex=-1
>
    <div style="width: 14px; height: 14px; display: inline-block;">&#128279;</div>
</a>

  <div class="doc_entry">
    <span class="doc_entry_children">
    <code>
      <span style="font-weight: 700;">prepareInit</span><span style="font-weight: 500;">(<span><span>isc<span>: <a href="../.././/~/IngestStepContext.html" class="link">IngestStepContext</a></span></span></span>): <span>Promise</span>&lt;<span>void</span>&gt;</span>
    </code>
    </span>
  </div>
  <div class="markdown"><p>Prepare the DuckDB path/database for initialization. Typically this gives
a chance for the path to the database to be created or removing the existing
database in case we want to initialize from scratch.</p>
</div>
</div>

  </div>
</div></div>
      </div>
    </article>
  
</main>


  <div id="searchResults"></div>
</div>

</body>
<script src="../../search_index.js" defer></script>
<script src="../../fuse.js" defer></script>
<script src="../../search.js" defer></script>
</html>

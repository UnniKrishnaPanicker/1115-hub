[
  {
    "insertable": {
      "exec_identity": "init",
      "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
      "sql": "\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Constitution', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL);\n\n-- no after-init SQL found",
      "orch_session_exec_id": "168a34c7-d043-5ec4-a84a-c961f1a301ef",
      "exec_nature": "duckdb",
      "exec_status": 0,
      "input_text": "\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Constitution', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL);\n\n-- no after-init SQL found",
      "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
      "narrative_md": "```sql\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'Constitution', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL);\n\n-- no after-init SQL found\n```\n"
    }
  },
  {
    "insertable": {
      "exec_identity": "ingest",
      "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json",
      "sql": "-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'abf5c680-a135-5d89-b871-fa5b9b99aed6' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'abf5c680-a135-5d89-b871-fa5b9b99aed6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'",
      "output_nature": "JSON",
      "orch_session_exec_id": "591191c7-f693-5957-8734-ac87151ca981",
      "exec_nature": "duckdb",
      "exec_status": 0,
      "input_text": "-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'abf5c680-a135-5d89-b871-fa5b9b99aed6' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'abf5c680-a135-5d89-b871-fa5b9b99aed6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'",
      "output_text": "[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'Admin_Demographic' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'QE_Admin_Data' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n",
      "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
      "narrative_md": "```sql\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_admin_demographic', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05e8feaa-0bed-5909-a817-39812494b361', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_screening', NULL);\n     \n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, 'abf5c680-a135-5d89-b871-fa5b9b99aed6' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_valid_01_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           'abf5c680-a135-5d89-b871-fa5b9b99aed6',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_valid_01_screening.',\n           'Ensure ahc_hrsn_valid_01_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', 'ahc_hrsn_valid_01_q_e_admin_data', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05e8feaa-0bed-5909-a817-39812494b361', '641dff51-97fd-56b3-8443-c1ed568a6d66', 'TODO', 'Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'synthetic_fail', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '47277588-99e8-59f5-8384-b24344a86073' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'synthetic_fail')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '47277588-99e8-59f5-8384-b24344a86073',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in synthetic_fail.',\n           'Ensure synthetic_fail contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05e8feaa-0bed-5909-a817-39812494b361', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05e8feaa-0bed-5909-a817-39812494b361', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05e8feaa-0bed-5909-a817-39812494b361', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05e8feaa-0bed-5909-a817-39812494b361', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv', 'ahc_hrsn_12_12_2023_valid', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05e8feaa-0bed-5909-a817-39812494b361' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY'), ('FIRST_NAME'), ('LAST_NAME'), ('PAT_BIRTH_DATE'), ('MEDICAID_CIN'), ('ENCOUNTER_ID'), ('SURVEY'), ('SURVEY_ID'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('SDOH_DOMAIN'), ('NEED_INDICATED'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_12_12_2023_valid')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_12_12_2023_valid.',\n           'Ensure ahc_hrsn_12_12_2023_valid contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05e8feaa-0bed-5909-a817-39812494b361'\n```\n\n### stdout\n```sh\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'Admin_Demographic' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook 'ahc-hrsn-valid-01.xlsx' sheet 'QE_Admin_Data' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n\n```"
    }
  },
  {
    "insertable": {
      "exec_identity": "ensureContent",
      "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
      "sql": "WITH numeric_value_in_all_rows AS (\n    SELECT 'SURVEY_ID' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;",
      "orch_session_exec_id": "071f8fe1-4899-5c71-9c86-7d7377661d45",
      "exec_nature": "duckdb",
      "exec_status": 0,
      "input_text": "WITH numeric_value_in_all_rows AS (\n    SELECT 'SURVEY_ID' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;",
      "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
      "narrative_md": "```sql\nWITH numeric_value_in_all_rows AS (\n    SELECT 'SURVEY_ID' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO '^[+-]?[0-9]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05e8feaa-0bed-5909-a817-39812494b361',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Data Type Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Non-integer value \"' || invalid_value || '\" found in ' || issue_column,\n           'Convert non-integer values to INTEGER'\n      FROM numeric_value_in_all_rows;\n```\n"
    }
  },
  {
    "insertable": {
      "exec_identity": "emitResources",
      "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
      "sql": "        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n\n        -- emit all the SQLPage content\n        CREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" DATE\n);\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''list'' as component;\nSELECT ''Screenings'' as title,''screenings.sql'' as link;\nSELECT ''Jon Doe Screening'' as title,''jondoe.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component;\nSELECT * FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('screenings.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;  \nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT * \n              FROM \"ahc_hrsn_12_12_2023_valid\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('jondoe.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''text'' as component, ''Jon Doe (11223344)'' as title, ''Test'' as contentsmd;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT pat_mrn_id, question, meas_value \n              FROM \"ahc_hrsn_12_12_2023_valid\"\n             WHERE pat_mrn_id = ''11223344'';\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT *\n              FROM \"ahc_hrsn_12_12_2023_valid_fhir\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n-- TODO: https://github.com/lovasoa/SQLpage/discussions/109#discussioncomment-7359513\n--       see the above for how to fix for SQLPage but figure out to use the same SQL\n--       in and out of SQLPage (maybe do what Ophir said in discussion and create\n--       custom output for SQLPage using components?)\nWITH TableInfo AS (\n  SELECT\n    m.tbl_name AS table_name,\n    CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n    c.name AS column_name,\n    c.\"type\" AS column_type,\n    CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n    COALESCE(c.dflt_value, '''') AS default_value,\n    COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs,\n    ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS row_num\n  FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n  WHERE m.type = ''table''\n  ORDER BY table_name, row_num\n),\nViews AS (\n  SELECT ''## Views '' AS markdown_output\n  UNION ALL\n  SELECT ''| View | Column | Type |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ---- | ------ |----- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' || tbl_name || '' | '' || c.name || '' | '' || c.\"type\" || '' | ''\n  FROM\n    sqlite_master m,\n    pragma_table_info(m.tbl_name) c\n  WHERE\n    m.type = ''view''\n),\nIndexes AS (\n  SELECT ''## Indexes'' AS markdown_output\n  UNION ALL\n  SELECT ''| Table | Index | Columns |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ----- | ----- | ------- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' ||  m.name || '' | '' || il.name || '' | '' || group_concat(ii.name, '', '') || '' |'' AS markdown_output\n  FROM sqlite_master as m,\n    pragma_index_list(m.name) AS il,\n    pragma_index_info(il.name) AS ii\n  WHERE\n    m.type = ''table''\n  GROUP BY\n    m.name,\n    il.name\n)\nSELECT\n    ''text'' as component,\n    ''Information Schema'' as title,\n    group_concat(markdown_output, ''\n'') AS contents_md\nFROM\n  (\n    SELECT ''## Tables'' AS markdown_output\n    UNION ALL\n    SELECT\n      CASE WHEN ti.row_num = 1 THEN ''\n### `'' || ti.table_name || ''` Table\n| PK | Column | Type | Req? | Default | References |\n| -- | ------ | ---- | ---- | ------- | ---------- |\n'' ||\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      ELSE\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      END\n    FROM TableInfo ti\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM\tViews\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM Indexes\n);\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n        \n        -- emit all the execution diagnostics\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'init', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found', NULL, NULL, NULL, '```sql\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found\n```\n', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ingest', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''', NULL, '[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n', 'JSON', '```sql\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''\n```\n\n### stdout\n```sh\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n\n```', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ensureContent', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, 'WITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;', NULL, NULL, NULL, '```sql\nWITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\n```\n', NULL);\n\n        ATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n        CREATE TABLE resource_db.device AS SELECT * FROM device;\n        CREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\n        CREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\n        CREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\n        CREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\n        CREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\n        CREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n        CREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n\n        DETACH DATABASE resource_db;\n        -- no after-finalize SQL provided",
      "orch_session_exec_id": "a530fe1b-57ef-5a90-8bea-835ece2483da",
      "exec_nature": "duckdb",
      "exec_status": 0,
      "input_text": "        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n\n        -- emit all the SQLPage content\n        CREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" DATE\n);\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''list'' as component;\nSELECT ''Screenings'' as title,''screenings.sql'' as link;\nSELECT ''Jon Doe Screening'' as title,''jondoe.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component;\nSELECT * FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('screenings.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;  \nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT * \n              FROM \"ahc_hrsn_12_12_2023_valid\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('jondoe.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''text'' as component, ''Jon Doe (11223344)'' as title, ''Test'' as contentsmd;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT pat_mrn_id, question, meas_value \n              FROM \"ahc_hrsn_12_12_2023_valid\"\n             WHERE pat_mrn_id = ''11223344'';\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT *\n              FROM \"ahc_hrsn_12_12_2023_valid_fhir\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n-- TODO: https://github.com/lovasoa/SQLpage/discussions/109#discussioncomment-7359513\n--       see the above for how to fix for SQLPage but figure out to use the same SQL\n--       in and out of SQLPage (maybe do what Ophir said in discussion and create\n--       custom output for SQLPage using components?)\nWITH TableInfo AS (\n  SELECT\n    m.tbl_name AS table_name,\n    CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n    c.name AS column_name,\n    c.\"type\" AS column_type,\n    CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n    COALESCE(c.dflt_value, '''') AS default_value,\n    COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs,\n    ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS row_num\n  FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n  WHERE m.type = ''table''\n  ORDER BY table_name, row_num\n),\nViews AS (\n  SELECT ''## Views '' AS markdown_output\n  UNION ALL\n  SELECT ''| View | Column | Type |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ---- | ------ |----- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' || tbl_name || '' | '' || c.name || '' | '' || c.\"type\" || '' | ''\n  FROM\n    sqlite_master m,\n    pragma_table_info(m.tbl_name) c\n  WHERE\n    m.type = ''view''\n),\nIndexes AS (\n  SELECT ''## Indexes'' AS markdown_output\n  UNION ALL\n  SELECT ''| Table | Index | Columns |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ----- | ----- | ------- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' ||  m.name || '' | '' || il.name || '' | '' || group_concat(ii.name, '', '') || '' |'' AS markdown_output\n  FROM sqlite_master as m,\n    pragma_index_list(m.name) AS il,\n    pragma_index_info(il.name) AS ii\n  WHERE\n    m.type = ''table''\n  GROUP BY\n    m.name,\n    il.name\n)\nSELECT\n    ''text'' as component,\n    ''Information Schema'' as title,\n    group_concat(markdown_output, ''\n'') AS contents_md\nFROM\n  (\n    SELECT ''## Tables'' AS markdown_output\n    UNION ALL\n    SELECT\n      CASE WHEN ti.row_num = 1 THEN ''\n### `'' || ti.table_name || ''` Table\n| PK | Column | Type | Req? | Default | References |\n| -- | ------ | ---- | ---- | ------- | ---------- |\n'' ||\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      ELSE\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      END\n    FROM TableInfo ti\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM\tViews\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM Indexes\n);\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n        \n        -- emit all the execution diagnostics\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'init', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found', NULL, NULL, NULL, '```sql\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found\n```\n', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ingest', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''', NULL, '[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n', 'JSON', '```sql\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''\n```\n\n### stdout\n```sh\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n\n```', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ensureContent', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, 'WITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;', NULL, NULL, NULL, '```sql\nWITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\n```\n', NULL);\n\n        ATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n        CREATE TABLE resource_db.device AS SELECT * FROM device;\n        CREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\n        CREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\n        CREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\n        CREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\n        CREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\n        CREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n        CREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n\n        DETACH DATABASE resource_db;\n        -- no after-finalize SQL provided",
      "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
      "narrative_md": "```sql\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n        INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05e8feaa-0bed-5909-a817-39812494b361', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', (make_timestamp(2024, 1, 6, 21, 47, 5.899)), NULL);\n\n        -- emit all the SQLPage content\n        CREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" DATE\n);\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''list'' as component;\nSELECT ''Screenings'' as title,''screenings.sql'' as link;\nSELECT ''Jon Doe Screening'' as title,''jondoe.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component;\nSELECT * FROM orch_session;\n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('screenings.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;  \nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT * \n              FROM \"ahc_hrsn_12_12_2023_valid\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('jondoe.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\nSELECT ''text'' as component, ''Jon Doe (11223344)'' as title, ''Test'' as contentsmd;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort;\n\n            SELECT pat_mrn_id, question, meas_value \n              FROM \"ahc_hrsn_12_12_2023_valid\"\n             WHERE pat_mrn_id = ''11223344'';\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT *\n              FROM \"ahc_hrsn_12_12_2023_valid_fhir\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''shell'' as component, ''QCS Orchestration Engine'' as title, ''book'' as icon, ''/'' as link, ''sessions'' as menu_item, ''schema'' as menu_item;\n    ;\n-- TODO: https://github.com/lovasoa/SQLpage/discussions/109#discussioncomment-7359513\n--       see the above for how to fix for SQLPage but figure out to use the same SQL\n--       in and out of SQLPage (maybe do what Ophir said in discussion and create\n--       custom output for SQLPage using components?)\nWITH TableInfo AS (\n  SELECT\n    m.tbl_name AS table_name,\n    CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n    c.name AS column_name,\n    c.\"type\" AS column_type,\n    CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n    COALESCE(c.dflt_value, '''') AS default_value,\n    COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs,\n    ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS row_num\n  FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n  WHERE m.type = ''table''\n  ORDER BY table_name, row_num\n),\nViews AS (\n  SELECT ''## Views '' AS markdown_output\n  UNION ALL\n  SELECT ''| View | Column | Type |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ---- | ------ |----- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' || tbl_name || '' | '' || c.name || '' | '' || c.\"type\" || '' | ''\n  FROM\n    sqlite_master m,\n    pragma_table_info(m.tbl_name) c\n  WHERE\n    m.type = ''view''\n),\nIndexes AS (\n  SELECT ''## Indexes'' AS markdown_output\n  UNION ALL\n  SELECT ''| Table | Index | Columns |'' AS markdown_output\n  UNION ALL\n  SELECT ''| ----- | ----- | ------- |'' AS markdown_output\n  UNION ALL\n  SELECT ''| '' ||  m.name || '' | '' || il.name || '' | '' || group_concat(ii.name, '', '') || '' |'' AS markdown_output\n  FROM sqlite_master as m,\n    pragma_index_list(m.name) AS il,\n    pragma_index_info(il.name) AS ii\n  WHERE\n    m.type = ''table''\n  GROUP BY\n    m.name,\n    il.name\n)\nSELECT\n    ''text'' as component,\n    ''Information Schema'' as title,\n    group_concat(markdown_output, ''\n'') AS contents_md\nFROM\n  (\n    SELECT ''## Tables'' AS markdown_output\n    UNION ALL\n    SELECT\n      CASE WHEN ti.row_num = 1 THEN ''\n### `'' || ti.table_name || ''` Table\n| PK | Column | Type | Req? | Default | References |\n| -- | ------ | ---- | ---- | ------- | ---------- |\n'' ||\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      ELSE\n        ''| '' || is_primary_key || '' | '' || ti.column_name || '' | '' || ti.column_type || '' | '' || ti.not_null || '' | '' || ti.default_value || '' | '' || ti.fk_refs || '' |''\n      END\n    FROM TableInfo ti\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM\tViews\n    UNION ALL SELECT ''''\n    UNION ALL SELECT * FROM Indexes\n);\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\n        \n        -- emit all the execution diagnostics\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'init', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found', NULL, NULL, NULL, '```sql\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMPTZ,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMPTZ DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''Constitution'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\") VALUES (''05e8feaa-0bed-5909-a817-39812494b361'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', NULL, NULL, NULL);\n\n-- no after-init SQL found\n```\n', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ingest', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''', NULL, '[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n', 'JSON', '```sql\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_admin_demographic'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''Admin_Demographic'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_screening'', NULL);\n     \n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_valid_01_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_valid_01_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''abf5c680-a135-5d89-b871-fa5b9b99aed6'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_valid_01_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''abf5c680-a135-5d89-b871-fa5b9b99aed6'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_valid_01_screening.'',\n           ''Ensure ahc_hrsn_valid_01_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx (ahc_hrsn_valid_01_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', ''ahc_hrsn_valid_01_q_e_admin_data'', NULL);\n        \nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''TODO'', ''Excel workbook ''''ahc-hrsn-valid-01.xlsx'''' sheet ''''QE_Admin_Data'''' has not been implemented yet.'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (synthetic_fail)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''synthetic_fail'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE synthetic_fail AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''47277588-99e8-59f5-8384-b24344a86073'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''synthetic_fail'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''47277588-99e8-59f5-8384-b24344a86073'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in synthetic_fail.'',\n           ''Ensure synthetic_fail contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv (ahc_hrsn_12_12_2023_valid)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05e8feaa-0bed-5909-a817-39812494b361'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'', ''ahc_hrsn_12_12_2023_valid'', NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_12_12_2023_valid AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05e8feaa-0bed-5909-a817-39812494b361'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-12-12-2023-valid.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY''), (''FIRST_NAME''), (''LAST_NAME''), (''PAT_BIRTH_DATE''), (''MEDICAID_CIN''), (''ENCOUNTER_ID''), (''SURVEY''), (''SURVEY_ID''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''SDOH_DOMAIN''), (''NEED_INDICATED''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT upper(trim(column_name))\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_12_12_2023_valid'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_12_12_2023_valid.'',\n           ''Ensure ahc_hrsn_12_12_2023_valid contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05e8feaa-0bed-5909-a817-39812494b361''\n```\n\n### stdout\n```sh\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''Admin_Demographic'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1b857fd6-c4bd-4983-8895-838f0ca4d319\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"9bc4ea2c-c958-4b9e-b3c4-895a095bc4bf\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"fd737f42-e5c0-45c0-8bf6-38fd72ae1b74\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"2c1574bc-9e82-405d-9c4c-d9a43cfe914f\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"8f53f351-2986-4313-a3b0-edecd336154b\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"1a3cbfc3-1b32-46c6-a309-f1b050970913\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"54a51c62-7734-48bb-bd6f-fbfaf8084c6a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"cc82261e-4b4e-4e3f-a555-572075329c66\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"ac513692-e9e0-46b9-9d8e-b2ad467d3e44\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d3cc2b49-759f-4607-bc23-402a37c006e7\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"609dbcfc-b949-47f9-ac8d-387f5580ffc8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"05490ae4-e0fa-403f-ae68-67de963f80af\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"376da591-5f92-4c2c-97b5-e8cc32efc5a5\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"b8265db7-06ac-4073-8b32-9345021ef32a\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"037449b9-513c-40df-b8ee-afd4da827671\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"94d23651-ae5c-4d48-8a5f-36984ee5fd6e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"98306097-8a78-4ffc-92e7-554c8d95aed4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"d5341699-5ee3-4924-8c23-87a4e6ac2bad\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"6b8ddece-df67-4487-8b89-e895576a7249\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"c89e55ee-a55f-4ecd-848c-878981fc4fac\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"5a8d83aa-36e4-4477-908c-04d3bff84bd6\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in ahc_hrsn_valid_01_screening.\",\"invalid_value\":null},\n{\"session_entry_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"orch_session_issue_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"issue_type\":\"TODO\",\"issue_message\":\"Excel workbook ''ahc-hrsn-valid-01.xlsx'' sheet ''QE_Admin_Data'' has not been implemented yet.\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-valid-01.xlsx\"},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"c87dfe5d-1ab6-406f-bd07-fcf6c45511a4\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_MRN_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1a6980aa-0d43-4796-a784-03e0d319cd05\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FACILITY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8cc7ce7b-d361-4502-b323-4a40f2ba2243\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column FIRST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be12ecbf-c08f-4dfb-a04f-af326ba4330e\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column LAST_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"7f034c48-78da-4631-8c7a-614b44f8f6ce\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column PAT_BIRTH_DATE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b10805d2-0afd-4c40-91b7-c26d8d28a765\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEDICAID_CIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"ede6a6c4-80e8-442b-be4f-f9917d29afd9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ENCOUNTER_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"1d616170-d1b3-470b-9263-a1fe3bfce729\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4b7f6515-fb93-4a1a-99be-e3c0dd8c9ce1\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SURVEY_ID is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"4a0fddb2-8390-419f-9df5-91e28b6fc7a9\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column RECORDED_TIME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"34160cc4-2cb7-46fe-9a40-1f098bdb42b2\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d2e44b8d-b5f8-4b2d-ba41-d8a15da0071c\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column MEAS_VALUE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"296feb73-a822-40ee-91a8-f6160d065f12\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"8674a4b5-ab7a-45a4-9ebc-61fc71c9ab79\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column QUESTION_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"07b2795f-dff3-4247-a716-4bac3f9fe2de\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"f325d4a9-f19c-4f3d-be4e-580466135a99\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column ANSWER_CODE_SYSTEM_NAME is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"fab6dee2-5c52-4477-907a-4f0b2d9ea5cb\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column SDOH_DOMAIN is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"be07b70a-3caa-47e4-bc00-db2034cbc07d\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column NEED_INDICATED is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"94f01b29-959f-4ef7-a894-58830b5543be\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_PART_2_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"d7ef1e9f-cd90-4650-9d51-15b19d669afa\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OMH_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"orch_session_issue_id\":\"b5f5ee76-e7e4-4bcb-92f1-f59718839eb8\",\"issue_type\":\"Missing Column\",\"issue_message\":\"Required column VISIT_OPWDD_FLAG is missing in synthetic_fail.\",\"invalid_value\":null},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"}]\n\n```', NULL);\n        INSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', 'duckdb', '05e8feaa-0bed-5909-a817-39812494b361', NULL, NULL, NULL, 'ensureContent', 'duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, 'WITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;', NULL, NULL, NULL, '```sql\nWITH numeric_value_in_all_rows AS (\n    SELECT ''SURVEY_ID'' AS issue_column,\n           SURVEY_ID AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM ahc_hrsn_12_12_2023_valid\n     WHERE SURVEY_ID IS NOT NULL\n       AND SURVEY_ID NOT SIMILAR TO ''^[+-]?[0-9]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05e8feaa-0bed-5909-a817-39812494b361'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Data Type Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Non-integer value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Convert non-integer values to INTEGER''\n      FROM numeric_value_in_all_rows;\n```\n', NULL);\n\n        ATTACH 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n        CREATE TABLE resource_db.device AS SELECT * FROM device;\n        CREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\n        CREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\n        CREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\n        CREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\n        CREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\n        CREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n        CREATE TABLE resource_db.ahc_hrsn_12_12_2023_valid AS SELECT * FROM ahc_hrsn_12_12_2023_valid;\n\nCREATE VIEW resource_db.ahc_hrsn_12_12_2023_valid_fhir AS \n  SELECT json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM ahc_hrsn_12_12_2023_valid;\n\n        DETACH DATABASE resource_db;\n        -- no after-finalize SQL provided\n```\n"
    }
  },
  {
    "insertable": {
      "exec_identity": "emitDiagnostics",
      "exec_code": "duckdb support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
      "sql": "INSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
      "orch_session_exec_id": "99e72a60-96ab-5ef1-a3af-3e7759777664",
      "exec_nature": "duckdb",
      "exec_status": 0,
      "input_text": "INSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
      "session_id": "05e8feaa-0bed-5909-a817-39812494b361",
      "narrative_md": "```sql\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO 'support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\n"
    }
  }
]
{
  "args": {
    "workflowPaths": {
      "inProcess": {
        "home": "/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e"
      },
      "egress": {
        "home": "/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e"
      }
    },
    "walkRootPaths": [
      "support/assurance/ahc-hrsn-elt/screening/synthetic-content"
    ],
    "referenceDataHome": "/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data",
    "sources": [
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv",
        "nature": "CSV",
        "tableName": "qe_admin_data_2_01hpkty3hctk826tvx5tasga55",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv",
        "nature": "ERROR",
        "tableName": "ERROR",
        "ingestionIssues": 1
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv",
        "nature": "CSV",
        "tableName": "screening_2_01hpkty3hctk826tvx5tasga55",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv",
        "nature": "CSV",
        "tableName": "demographic_data_2_01hpkty3hctk826tvx5tasga55",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_2024_01_25_valid_admin_demographic",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_2024_01_25_valid_screening",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_2024_01_25_valid_q_e_admin_data",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_2024_01_25_valid_question_reference",
        "ingestionIssues": 0
      },
      {
        "uri": "support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx",
        "nature": "Excel Workbook Sheet",
        "tableName": "ahc_hrsn_2024_01_25_valid_answer_reference",
        "ingestionIssues": 0
      }
    ]
  },
  "diags": [
    {
      "insertable": {
        "exec_identity": "init",
        "exec_code": "duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'EXCELSIOR', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', ('2024-02-16T16:13:30.775Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Lvl': 'VARCHAR',\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR'\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Worksheet': 'VARCHAR',\n      'Field': 'VARCHAR',\n      'Required': 'VARCHAR',\n      'Permissible Values': 'VARCHAR', \n      'Criteria-1': 'VARCHAR',\n      'Criteria-2': 'VARCHAR',\n      'Criteria-3': 'VARCHAR',\n      'Criteria-4': 'VARCHAR',\n      'Criteria-5': 'VARCHAR',\n      'Criteria-6': 'VARCHAR',\n      'Criteria-7': 'VARCHAR',\n      'Remarks': 'VARCHAR'\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'SCREENING_CODE': 'VARCHAR',\n      'SCREENING_CODE_DESCRIPTION': 'VARCHAR',\n      'QUESTION': 'VARCHAR',\n      'QUESTION_CODE': 'VARCHAR',\n      'ANSWER_VALUE': 'VARCHAR',\n      'ANSWER_CODE': 'VARCHAR',\n      'SCORE': 'VARCHAR',\n      'UCUM Units': 'VARCHAR',\n      'SDOH_DOMAIN': 'VARCHAR',\n      'POTENTIAL_NEED_INDICATED': 'VARCHAR',\n    });\n\n-- no after-init SQL found",
        "orch_session_exec_id": "168a34c7-d043-5ec4-a84a-c961f1a301ef",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'EXCELSIOR', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', ('2024-02-16T16:13:30.775Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Lvl': 'VARCHAR',\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR'\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Worksheet': 'VARCHAR',\n      'Field': 'VARCHAR',\n      'Required': 'VARCHAR',\n      'Permissible Values': 'VARCHAR', \n      'Criteria-1': 'VARCHAR',\n      'Criteria-2': 'VARCHAR',\n      'Criteria-3': 'VARCHAR',\n      'Criteria-4': 'VARCHAR',\n      'Criteria-5': 'VARCHAR',\n      'Criteria-6': 'VARCHAR',\n      'Criteria-7': 'VARCHAR',\n      'Remarks': 'VARCHAR'\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'SCREENING_CODE': 'VARCHAR',\n      'SCREENING_CODE_DESCRIPTION': 'VARCHAR',\n      'QUESTION': 'VARCHAR',\n      'QUESTION_CODE': 'VARCHAR',\n      'ANSWER_VALUE': 'VARCHAR',\n      'ANSWER_CODE': 'VARCHAR',\n      'SCORE': 'VARCHAR',\n      'UCUM Units': 'VARCHAR',\n      'SDOH_DOMAIN': 'VARCHAR',\n      'POTENTIAL_NEED_INDICATED': 'VARCHAR',\n    });\n\n-- no after-init SQL found",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from 'orch_session'\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, '%Y-%m-%d %H:%M:%S') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, '%Y-%m-%d %H:%M:%S') AS orch_finished_at,\n    \n        -- Including all columns from 'orch_session_entry'\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from 'orch_session_issue'\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES ('7bab389e-54af-5a13-a39f-079abdc73a48', 'EXCELSIOR', 'SINGLETON', 'UNKNOWN', NULL, '{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES ('05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7bab389e-54af-5a13-a39f-079abdc73a48', ('2024-02-16T16:13:30.775Z'), NULL, NULL, NULL, NULL, 'Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Lvl': 'VARCHAR',\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'Display': 'VARCHAR',\n      'Definition': 'VARCHAR'\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Code': 'VARCHAR',\n      'System': 'VARCHAR',\n      'Display': 'VARCHAR'\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'Worksheet': 'VARCHAR',\n      'Field': 'VARCHAR',\n      'Required': 'VARCHAR',\n      'Permissible Values': 'VARCHAR', \n      'Criteria-1': 'VARCHAR',\n      'Criteria-2': 'VARCHAR',\n      'Criteria-3': 'VARCHAR',\n      'Criteria-4': 'VARCHAR',\n      'Criteria-5': 'VARCHAR',\n      'Criteria-6': 'VARCHAR',\n      'Criteria-7': 'VARCHAR',\n      'Remarks': 'VARCHAR'\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto('/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv',\n    delim = ',',\n    header = true,\n    columns = {\n      'SCREENING_CODE': 'VARCHAR',\n      'SCREENING_CODE_DESCRIPTION': 'VARCHAR',\n      'QUESTION': 'VARCHAR',\n      'QUESTION_CODE': 'VARCHAR',\n      'ANSWER_VALUE': 'VARCHAR',\n      'ANSWER_CODE': 'VARCHAR',\n      'SCORE': 'VARCHAR',\n      'UCUM Units': 'VARCHAR',\n      'SDOH_DOMAIN': 'VARCHAR',\n      'POTENTIAL_NEED_INDICATED': 'VARCHAR',\n    });\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ingest",
        "exec_code": "duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'Unknown CSV File Type', 'CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'abf5c680-a135-5d89-b871-fa5b9b99aed6', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd70a4700-6b40-52fc-a7a2-69ef0d7f69ff', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '071f8fe1-4899-5c71-9c86-7d7377661d45', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '99e72a60-96ab-5ef1-a3af-3e7759777664', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '89f7ec04-277a-5799-afaa-a70d0f2a8ed5', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5222b730-9add-5b52-b0c9-6f2506b0af9d', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'c302047e-21cf-5059-a32c-e81a9bd3a9b9', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '4971a2f5-06a3-5898-823d-364145d3b9a5', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8640a4b5-53ef-506e-bcde-83f00315d4b2', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e6951d0b-be59-58c3-8a04-01181208c601', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'screening_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM_NAME'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED'), ('ASSISTANCE_REQUESTED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'demographic_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '80af4eff-d697-565b-9e3f-a587e322b1da' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX _CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX _CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'demographic_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_admin_demographic', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Admin_Demographic' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '5b77d127-e62a-50a9-acee-bea63ff64dd5' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Admin_Demographic', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADDRESS1'), ('ADDRESS2'), ('ADMINISTRATIVE_SEX'), ('CITY'), ('CONSENT '), ('ENCOUNTER_ID'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('FACILITY ID (Assigning authority)'), ('FIRST_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_DESCRIPTION'), ('LAST_NAME'), ('MEDICAID_CIN'), ('MIDDLE_NAME'), ('MPI_ID'), ('PAT_BIRTH_DATE'), ('PAT_MRN_ID'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('SEX_AT_BIRTH'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('STATE'), ('ZIP')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_admin_demographic')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.',\n           'Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ANSWER_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ASSISTANCE_REQUESTED'), ('FACILITY ID (Assigning authority)'), ('MEAS_VALUE'), ('PARENT_QUESTION_CODE'), ('PAT_MRN_ID'), ('POTENTIAL_NEED_INDICATED'), ('QUESTION_CODE_SYSTEM_NAME'), ('QUESTION_CODE'), ('QUESTION'), ('RECORDED_TIME'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_METHOD'), ('SCREENING_NAME'), ('SDOH_DOMAIN'), ('UCUM_UNITS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_screening.',\n           'Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_q_e_admin_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'QE_Admin_Data' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'f6d4aff4-4b71-5662-8f57-00ee247dc57c' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='QE_Admin_Data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_q_e_admin_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.',\n           'Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_question_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Question_Reference' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '657d6337-8d24-5b67-b139-87db6a228264' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Question_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('QUESTION_CODE'), ('QUESTION'), ('SDOH_DOMAIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_question_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '657d6337-8d24-5b67-b139-87db6a228264',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_question_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_answer_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Answer_Reference' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e2816d61-4406-5073-ac60-f129a107d938' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Answer_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('QUESTION_CODE'), ('ANSWER_CODE'), ('MEAS_VALUE')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_answer_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e2816d61-4406-5073-ac60-f129a107d938',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'",
        "output_nature": "JSON",
        "orch_session_exec_id": "bebf797d-855b-5e76-93d2-2a802febd5a2",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'Unknown CSV File Type', 'CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'abf5c680-a135-5d89-b871-fa5b9b99aed6', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd70a4700-6b40-52fc-a7a2-69ef0d7f69ff', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '071f8fe1-4899-5c71-9c86-7d7377661d45', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '99e72a60-96ab-5ef1-a3af-3e7759777664', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '89f7ec04-277a-5799-afaa-a70d0f2a8ed5', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5222b730-9add-5b52-b0c9-6f2506b0af9d', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'c302047e-21cf-5059-a32c-e81a9bd3a9b9', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '4971a2f5-06a3-5898-823d-364145d3b9a5', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8640a4b5-53ef-506e-bcde-83f00315d4b2', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e6951d0b-be59-58c3-8a04-01181208c601', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'screening_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM_NAME'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED'), ('ASSISTANCE_REQUESTED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'demographic_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '80af4eff-d697-565b-9e3f-a587e322b1da' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX _CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX _CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'demographic_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_admin_demographic', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Admin_Demographic' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '5b77d127-e62a-50a9-acee-bea63ff64dd5' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Admin_Demographic', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADDRESS1'), ('ADDRESS2'), ('ADMINISTRATIVE_SEX'), ('CITY'), ('CONSENT '), ('ENCOUNTER_ID'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('FACILITY ID (Assigning authority)'), ('FIRST_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_DESCRIPTION'), ('LAST_NAME'), ('MEDICAID_CIN'), ('MIDDLE_NAME'), ('MPI_ID'), ('PAT_BIRTH_DATE'), ('PAT_MRN_ID'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('SEX_AT_BIRTH'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('STATE'), ('ZIP')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_admin_demographic')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.',\n           'Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ANSWER_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ASSISTANCE_REQUESTED'), ('FACILITY ID (Assigning authority)'), ('MEAS_VALUE'), ('PARENT_QUESTION_CODE'), ('PAT_MRN_ID'), ('POTENTIAL_NEED_INDICATED'), ('QUESTION_CODE_SYSTEM_NAME'), ('QUESTION_CODE'), ('QUESTION'), ('RECORDED_TIME'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_METHOD'), ('SCREENING_NAME'), ('SDOH_DOMAIN'), ('UCUM_UNITS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_screening.',\n           'Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_q_e_admin_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'QE_Admin_Data' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'f6d4aff4-4b71-5662-8f57-00ee247dc57c' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='QE_Admin_Data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_q_e_admin_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.',\n           'Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_question_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Question_Reference' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '657d6337-8d24-5b67-b139-87db6a228264' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Question_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('QUESTION_CODE'), ('QUESTION'), ('SDOH_DOMAIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_question_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '657d6337-8d24-5b67-b139-87db6a228264',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_question_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_answer_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Answer_Reference' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e2816d61-4406-5073-ac60-f129a107d938' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Answer_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('QUESTION_CODE'), ('ANSWER_CODE'), ('MEAS_VALUE')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_answer_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e2816d61-4406-5073-ac60-f129a107d938',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'",
        "output_text": "[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'ahc-hrsn-2023-12-12-valid.csv' not found in 'ahc-hrsn-2023-12-12-valid.csv'\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'ahc-hrsn-2023-12-25-valid.xlsx' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'ahc-hrsn-2023-12-25-valid.xlsx' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'synthetic-fail.csv' not found in 'synthetic-fail.csv'\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8b7c669c-1795-5f6b-8f3a-3e502b74c628', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('7b979b68-7227-53fd-b689-e4fe153afb76', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8b7c669c-1795-5f6b-8f3a-3e502b74c628', 'Unknown CSV File Type', 'CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('abf5c680-a135-5d89-b871-fa5b9b99aed6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('641dff51-97fd-56b3-8443-c1ed568a6d66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'abf5c680-a135-5d89-b871-fa5b9b99aed6', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d70a4700-6b40-52fc-a7a2-69ef0d7f69ff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('47277588-99e8-59f5-8384-b24344a86073', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd70a4700-6b40-52fc-a7a2-69ef0d7f69ff', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('58b22e99-5854-53bf-adbe-08e67df99b85', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a26ce332-3ced-5623-861d-23a2ef78e4a9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '58b22e99-5854-53bf-adbe-08e67df99b85', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('ae477ba1-c7f1-5f34-847a-50bddb7130aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'bc0c03b5-d1ba-5301-850f-5e4c42c1bf09', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('591191c7-f693-5957-8734-ac87151ca981', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'qe_admin_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3b4eb0e5-6239-537a-8e67-e50e172e72a2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('071f8fe1-4899-5c71-9c86-7d7377661d45', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('86b4a49e-7378-5159-9f41-b005208c31bc', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '071f8fe1-4899-5c71-9c86-7d7377661d45', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('a530fe1b-57ef-5a90-8bea-835ece2483da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('a3fe7098-8ae8-5612-81ac-cbe10780c19b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'a530fe1b-57ef-5a90-8bea-835ece2483da', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('99e72a60-96ab-5ef1-a3af-3e7759777664', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('e36daa69-3c63-5384-b6a7-03fa3b00641d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '99e72a60-96ab-5ef1-a3af-3e7759777664', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('89f7ec04-277a-5799-afaa-a70d0f2a8ed5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c60cf3db-b1bf-5103-b278-b0c128ce924a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '89f7ec04-277a-5799-afaa-a70d0f2a8ed5', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('b10e248d-8c94-59ec-83fc-a1249dd3b111', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5222b730-9add-5b52-b0c9-6f2506b0af9d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('fa7874f6-f848-572b-a9ab-9db4c8d5e959', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5222b730-9add-5b52-b0c9-6f2506b0af9d', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('c302047e-21cf-5059-a32c-e81a9bd3a9b9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('3252fee6-3a9a-5f4c-81c6-739201046d79', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'c302047e-21cf-5059-a32c-e81a9bd3a9b9', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('9860873a-c387-5d98-9930-4ff296eb7192', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '78d6a904-035e-54ae-8ac2-ca5cdf3f75f7', 'Sheet Missing', 'Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('46171763-bd21-57a8-a403-0785f72643cf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'd5d6e25d-81b4-5f98-8b91-ea2dbc155a9c', 'Sheet Missing', 'Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('4971a2f5-06a3-5898-823d-364145d3b9a5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('c2c0cbca-70cb-54f6-9dc7-66b47c4f3157', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '4971a2f5-06a3-5898-823d-364145d3b9a5', 'Sheet Missing', 'Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('8640a4b5-53ef-506e-bcde-83f00315d4b2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('544998d3-58c5-5f65-9dc8-9f998508495f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '8640a4b5-53ef-506e-bcde-83f00315d4b2', 'Sheet Missing', 'Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('10d0290c-b2eb-581e-b627-b5b8fcbb830f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0adb81bc-3df2-5f86-99cc-2d20e1dd5efd', 'Sheet Missing', 'Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e6951d0b-be59-58c3-8a04-01181208c601', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', 'ERROR', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES ('2afb3098-bcfd-5a54-8ebb-4d65d399c55e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e6951d0b-be59-58c3-8a04-01181208c601', 'Unknown CSV File Type', 'CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''', NULL, NULL, 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'screening_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('e8b3dab4-5058-5c79-8088-45b423119149', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY_ID'), ('ENCOUNTER_ID'), ('ENCOUNTER_CLASS_CODE_SYSTEM'), ('ENCOUNTER_CLASS_CODE'), ('ENCOUNTER_CLASS_CODE_DESCRIPTION'), ('ENCOUNTER_STATUS_CODE_SYSTEM'), ('ENCOUNTER_STATUS_CODE'), ('ENCOUNTER_STATUS_CODE_DESCRIPTION'), ('ENCOUNTER_TYPE_CODE_SYSTEM_NAME'), ('ENCOUNTER_TYPE_CODE'), ('ENCOUNTER_TYPE_CODE_DESCRIPTION'), ('SCREENING_CODE_DESCRIPTION'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_STATUS_CODE_DESCRIPTION'), ('SCREENING_STATUS_CODE'), ('SCREENING_STATUS_CODE_SYSTEM'), ('RECORDED_TIME'), ('QUESTION'), ('MEAS_VALUE'), ('UCUM_UNITS'), ('QUESTION_CODE'), ('QUESTION_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ANSWER_CODE_SYSTEM_NAME'), ('PARENT_QUESTION_CODE'), ('SDOH_DOMAIN'), ('POTENTIAL_NEED_INDICATED'), ('ASSISTANCE_REQUESTED')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'screening_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in screening_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9dabd022-4a26-55f2-98f4-e534e7704b23', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'ScreeningCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('80af4eff-d697-565b-9e3f-a587e322b1da', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv', 'demographic_data_2_01hpkty3hctk826tvx5tasga55', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6fcd9df5-34cf-5c09-8fb5-e73617e28d73', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ENTER(ingest)', 'ATTEMPT_CSV_INGEST', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '80af4eff-d697-565b-9e3f-a587e322b1da' as session_entry_id\n    FROM read_csv_auto('support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('MPI_ID'), ('PAT_MRN_ID'), ('FACILITY_ID'), ('CONSENT'), ('FIRST_NAME'), ('MIDDLE_NAME'), ('LAST_NAME'), ('ADMINISTRATIVE_SEX_CODE'), ('ADMINISTRATIVE_SEX _CODE_DESCRIPTION'), ('ADMINISTRATIVE_SEX _CODE_SYSTEM'), ('SEX_AT_BIRTH_CODE'), ('SEX_AT_BIRTH_CODE_DESCRIPTION'), ('SEX_AT_BIRTH_CODE_SYSTEM'), ('PAT_BIRTH_DATE'), ('ADDRESS1'), ('ADDRESS2'), ('CITY'), ('STATE'), ('ZIP'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_DESCRIPTION'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('MEDICAID_CIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'demographic_data_2_01hpkty3hctk826tvx5tasga55')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.',\n           'Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7e65e3a7-4415-55f4-866b-3b0cc4e85fc6', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_INGEST', 'INGESTED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('5b77d127-e62a-50a9-acee-bea63ff64dd5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_admin_demographic', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a92a6466-6fe4-58d7-8948-e2e09dc2fec2', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Admin_Demographic' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '5b77d127-e62a-50a9-acee-bea63ff64dd5' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Admin_Demographic', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ADDRESS1'), ('ADDRESS2'), ('ADMINISTRATIVE_SEX'), ('CITY'), ('CONSENT '), ('ENCOUNTER_ID'), ('ETHNICITY_CODE'), ('ETHNICITY_CODE_DESCRIPTION'), ('ETHNICITY_CODE_SYSTEM_NAME'), ('FACILITY ID (Assigning authority)'), ('FIRST_NAME'), ('GENDER_IDENTITY_CODE'), ('GENDER_IDENTITY_CODE_SYSTEM_NAME'), ('GENDER_IDENTITY_DESCRIPTION'), ('LAST_NAME'), ('MEDICAID_CIN'), ('MIDDLE_NAME'), ('MPI_ID'), ('PAT_BIRTH_DATE'), ('PAT_MRN_ID'), ('PREFERRED_LANGUAGE_CODE'), ('PREFERRED_LANGUAGE_CODE_SYSTEM_NAME'), ('PREFERRED_LANGUAGE_DESCRIPTION'), ('RACE_CODE'), ('RACE_CODE_DESCRIPTION'), ('RACE_CODE_SYSTEM_NAME'), ('SEX_AT_BIRTH'), ('SEXUAL_ORIENTATION_CODE'), ('SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'), ('SEXUAL_ORIENTATION_DESCRIPTION'), ('STATE'), ('ZIP')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_admin_demographic')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.',\n           'Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('34e90086-3d06-5b10-972d-7d0b40a02289', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_screening', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4f7e4436-c5f6-5ba1-9793-580ab66789fb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Screening' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Screening', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('ANSWER_CODE_SYSTEM_NAME'), ('ANSWER_CODE'), ('ASSISTANCE_REQUESTED'), ('FACILITY ID (Assigning authority)'), ('MEAS_VALUE'), ('PARENT_QUESTION_CODE'), ('PAT_MRN_ID'), ('POTENTIAL_NEED_INDICATED'), ('QUESTION_CODE_SYSTEM_NAME'), ('QUESTION_CODE'), ('QUESTION'), ('RECORDED_TIME'), ('SCREENING_CODE_SYSTEM_NAME'), ('SCREENING_CODE'), ('SCREENING_METHOD'), ('SCREENING_NAME'), ('SDOH_DOMAIN'), ('UCUM_UNITS')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_screening')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_screening.',\n           'Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('86ff3ab6-900d-5474-b63c-cbcac3c66f1a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('f6d4aff4-4b71-5662-8f57-00ee247dc57c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_q_e_admin_data', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6202ec4a-f3d5-5302-9ed6-9cb59a5b2818', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'QE_Admin_Data' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'f6d4aff4-4b71-5662-8f57-00ee247dc57c' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='QE_Admin_Data', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('PAT_MRN_ID'), ('FACILITY ID (Assigning authority)'), ('FACILITY_LONG_NAME'), ('ORGANIZATION_TYPE'), ('FACILITY ADDRESS1'), ('FACILITY ADDRESS2'), ('FACILITY CITY'), ('FACILITY STATE'), ('FACILITY ZIP'), ('VISIT_PART_2_FLAG'), ('VISIT_OMH_FLAG'), ('VISIT_OPWDD_FLAG')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_q_e_admin_data')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.',\n           'Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7537b2-9d60-59f3-8c61-fa2ff4265c02', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('657d6337-8d24-5b67-b139-87db6a228264', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_question_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9f13dd7d-9ff8-509d-b716-cde856c5f0f0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Question_Reference' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, '657d6337-8d24-5b67-b139-87db6a228264' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Question_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('SCREENING_CODE'), ('QUESTION_CODE'), ('QUESTION'), ('SDOH_DOMAIN')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_question_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '657d6337-8d24-5b67-b139-87db6a228264',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_question_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('9c0d34d3-bf09-527a-aef5-85004a400be5', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES ('e2816d61-4406-5073-ac60-f129a107d938', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', 'ahc_hrsn_2024_01_25_valid_answer_reference', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('413ec5cd-eee9-5c62-90a5-6670f8b9ddff', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ENTER(ingest)', 'ATTEMPT_EXCEL_INGEST', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet 'Answer_Reference' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, '05269d28-15ae-5bd6-bd88-f949ccfa52d7' as session_id, 'e2816d61-4406-5073-ac60-f129a107d938' as session_entry_id\n    FROM st_read('support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx', layer='Answer_Reference', open_options=['HEADERS=FORCE', 'FIELD_TYPES=AUTO']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES ('QUESTION_CODE'), ('ANSWER_CODE'), ('MEAS_VALUE')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = 'ahc_hrsn_2024_01_25_valid_answer_reference')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'e2816d61-4406-5073-ac60-f129a107d938',\n           'Missing Column',\n           'Required column ' || column_name || ' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.',\n           'Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"' || column_name || '\"'\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6c48996f-0dd4-572f-b087-e5913926cd4b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_INGEST', 'INGESTED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.ingestSQL', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = '05269d28-15ae-5bd6-bd88-f949ccfa52d7'\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'ahc-hrsn-2023-12-12-valid.csv' not found in 'ahc-hrsn-2023-12-12-valid.csv'\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'ahc-hrsn-2023-12-25-valid.xlsx' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'ahc-hrsn-2023-12-25-valid.xlsx' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'jrchc-hrsn-file-spec.xlsx' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Admin_Demographic' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Screening' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'QE_Admin_Data' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Question_Reference' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet 'Answer_Reference' not found in 'synthetic-fail-excel-01.xlsx' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file 'synthetic-fail.csv' not found in 'synthetic-fail.csv'\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n\n```\nNo STDERR emitted by `ingest`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "ensureContent",
        "exec_code": "duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5a941253-b661-5282-a5e6-97cbfe5dfb32', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Encounter Class',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Encounter Class \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Encounter Class Code with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f58ee169-7478-59ca-9e36-aa384ddb501c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN ('M', 'F', 'X (UN)', 'UNK', 'OTH. ASKU')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')',\n           'Use only allowed values ''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN ('M', 'F', 'ASKU', 'OTH', 'UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')',\n           'Use only allowed values ''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'' in ' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN ('Male', 'Female', 'Asked but Unknown', 'Other', 'Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')',\n           'Use only allowed values ''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX _CODE_DESCRIPTION' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN ('Male','Female','Asked but Unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN ('Yes','No','Y','N','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''Y'',''N'',''Unknown'')',\n           'Use only allowed values ''Yes'',''No'',''Y'',''N'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3cab2329-2aae-5475-9792-04e14e862f1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_DESCRIPTION' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN ('Female-to-Male (FTM)','Transgender Male','Trans Man','Female','Male','Genderqueer','Male-to-Female (MTF)', 'Transgender Female','Trans Woman','Asked but unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b63bd83d-959a-5a5f-8d60-08b84bf16c90', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8278fd0f-7116-55bd-8d7a-0a30681b0d2f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_NAME' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_METHOD' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN ('In-Person', 'Phone', 'Website')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''In-Person'', ''Phone'', ''Website'')',\n           'Use only allowed values ''In-Person'', ''Phone'', ''Website'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Screening Question',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Screening Question \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate screening questions with question reference data'\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('47d97ff4-908a-50f7-a2e2-443e2dad7056', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c420c3ba-ddbc-582b-9cdf-361497beb034', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('90a0010e-213e-58c3-9302-5e7310006b95', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('97c2cca2-92f5-5937-97e6-d84beeb4018e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f626602e-8be5-5e8c-824c-bdde91b22817', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('442b5e69-76fb-5da8-ae00-b79ea50cbedb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('398104b8-02dc-509b-998a-0b66b5a912e1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    ",
        "orch_session_exec_id": "5476830d-6cd9-5866-a105-7049aa24426d",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5a941253-b661-5282-a5e6-97cbfe5dfb32', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Encounter Class',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Encounter Class \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Encounter Class Code with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f58ee169-7478-59ca-9e36-aa384ddb501c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN ('M', 'F', 'X (UN)', 'UNK', 'OTH. ASKU')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')',\n           'Use only allowed values ''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN ('M', 'F', 'ASKU', 'OTH', 'UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')',\n           'Use only allowed values ''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'' in ' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN ('Male', 'Female', 'Asked but Unknown', 'Other', 'Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')',\n           'Use only allowed values ''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX _CODE_DESCRIPTION' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN ('Male','Female','Asked but Unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN ('Yes','No','Y','N','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''Y'',''N'',''Unknown'')',\n           'Use only allowed values ''Yes'',''No'',''Y'',''N'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3cab2329-2aae-5475-9792-04e14e862f1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_DESCRIPTION' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN ('Female-to-Male (FTM)','Transgender Male','Trans Man','Female','Male','Genderqueer','Male-to-Female (MTF)', 'Transgender Female','Trans Woman','Asked but unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b63bd83d-959a-5a5f-8d60-08b84bf16c90', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8278fd0f-7116-55bd-8d7a-0a30681b0d2f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_NAME' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_METHOD' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN ('In-Person', 'Phone', 'Website')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''In-Person'', ''Phone'', ''Website'')',\n           'Use only allowed values ''In-Person'', ''Phone'', ''Website'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Screening Question',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Screening Question \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate screening questions with question reference data'\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('47d97ff4-908a-50f7-a2e2-443e2dad7056', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c420c3ba-ddbc-582b-9cdf-361497beb034', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('90a0010e-213e-58c3-9302-5e7310006b95', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('97c2cca2-92f5-5937-97e6-d84beeb4018e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f626602e-8be5-5e8c-824c-bdde91b22817', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('442b5e69-76fb-5da8-ae00-b79ea50cbedb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('398104b8-02dc-509b-998a-0b66b5a912e1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    ",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c40829eb-7f91-583a-8af8-06de851777a0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('5a941253-b661-5282-a5e6-97cbfe5dfb32', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'QeAdminDataCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('a8ec8b43-9e16-5eeb-9683-bc14288971f1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN ('96777-8', '97023-6')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''96777-8'', ''97023-6'')',\n           'Use only allowed values ''96777-8'', ''97023-6'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT 'ENCOUNTER_CLASS_CODE' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Encounter Class',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Encounter Class \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate Encounter Class Code with encounter class reference data'\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f58ee169-7478-59ca-9e36-aa384ddb501c', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'ScreeningCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('35c62034-5b20-5891-8d38-3e9b051dec6e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'INGESTED_CSV', 'ATTEMPT_CSV_ASSURANCE', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX_CODE' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN ('M', 'F', 'X (UN)', 'UNK', 'OTH. ASKU')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')',\n           'Use only allowed values ''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN ('M', 'F', 'ASKU', 'OTH', 'UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')',\n           'Use only allowed values ''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'' in ' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH_CODE_DESCRIPTION' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN ('Male', 'Female', 'Asked but Unknown', 'Other', 'Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')',\n           'Use only allowed values ''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX _CODE_DESCRIPTION' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN ('Male','Female','Asked but Unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_ID' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN ('Yes','No','Y','N','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '80af4eff-d697-565b-9e3f-a587e322b1da',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''Y'',''N'',''Unknown'')',\n           'Use only allowed values ''Yes'',''No'',''Y'',''N'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3cab2329-2aae-5475-9792-04e14e862f1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_ASSURANCE', 'ASSURED_CSV', NULL, 'AdminDemographicCsvFileIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FIRST_NAME' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'MIDDLE_NAME' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'LAST_NAME' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO '^[A-Za-z]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]+$',\n           'Follow the pattern ^[A-Za-z]+$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'ADMINISTRATIVE_SEX' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT 'SEX_AT_BIRTH' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN ('M','F','X')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''M'',''F'',''X'')',\n           'Use only allowed values ''M'',''F'',''X'' in ' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT 'PAT_BIRTH_DATE' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Birth Date \"' || invalid_value || '\" found in ' || issue_column,\n           'Provide a valid birthdate on or after 1915.'\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'CITY' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'STATE' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'ZIP' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT 'ADDRESS1' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN ('407377005','446141000124107','446151000124109','446131000124102','407376001','ASKU','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')',\n           'Use only allowed values ''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_DESCRIPTION' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN ('Female-to-Male (FTM)','Transgender Male','Trans Man','Female','Male','Genderqueer','Male-to-Female (MTF)', 'Transgender Female','Trans Woman','Asked but unknown','Other','Unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')',\n           'Use only allowed values ''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'GENDER_IDENTITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN ('42035005','20430005','38628009','OTH','UNK')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')',\n           'Use only allowed values ''42035005'',''20430005'',''38628009'',''OTH'',''UNK'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_CODE_SYSTEM_NAME' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN ('SNOMED-CT','SNOMED')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''SNOMED-CT'',''SNOMED'')',\n           'Use only allowed values ''SNOMED-CT'',''SNOMED'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'SEXUAL_ORIENTATION_DESCRIPTION' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN ('Bisexual','Straight','Gay or lesbian','other','unknown')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')',\n           'Use only allowed values ''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'RACE_CODE_SYSTEM_NAME' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ETHNICITY_CODE_SYSTEM_NAME' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN ('CDC','CDCRE')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''CDC'',''CDCRE'')',\n           'Use only allowed values ''CDC'',''CDCRE'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'MPI_ID' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT 'MEDICAID_CIN' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO '^[A-Za-z]{2}\\d{5}[A-Za-z]$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$',\n           'Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in ' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT 'CONSENT ' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '5b77d127-e62a-50a9-acee-bea63ff64dd5',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('b63bd83d-959a-5a5f-8d60-08b84bf16c90', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AdminDemographicExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8278fd0f-7116-55bd-8d7a-0a30681b0d2f', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_NAME' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_CODE_SYSTEM_NAME' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN ('LN', 'LOINC')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'', ''LOINC'')',\n           'Use only allowed values ''LN'', ''LOINC'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SCREENING_CODE' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'SCREENING_METHOD' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN ('In-Person', 'Phone', 'Website')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''In-Person'', ''Phone'', ''Website'')',\n           'Use only allowed values ''In-Person'', ''Phone'', ''Website'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT 'RECORDED_TIME' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Date',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid timestamp \"' || invalid_value || '\" found in ' || issue_column,\n           'Please be sure to provide both a valid date and time.'\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT 'QUESTION' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'MEAS_VALUE' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'QUESTION_CODE_SYSTEM_NAME' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ANSWER_CODE_SYSTEM_NAME' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN ('LN','LOIN')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''LN'',''LOIN'')',\n           'Use only allowed values ''LN'',''LOIN'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'SDOH_DOMAIN' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'POTENTIAL_NEED_INDICATED' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT 'ASSISTANCE_REQUESTED' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN ('Yes','No','NA')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'',''No'',''NA'')',\n           'Use only allowed values ''Yes'',''No'',''NA'' in ' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT 'QUESTION_CODE' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66',\n           'Invalid Screening Question',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Invalid Screening Question \"' || invalid_value || '\" found in ' || issue_column,\n           'Validate screening questions with question reference data'\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('47d97ff4-908a-50f7-a2e2-443e2dad7056', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'ScreeningExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('c420c3ba-ddbc-582b-9cdf-361497beb034', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT 'PAT_MRN_ID' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ID (Assigning authority)' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'ORGANIZATION_TYPE' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN ('Hospital', 'DTC', 'SNF', 'SCN', 'CBO', 'OMH', 'OASAS', 'Practice', 'Article 36', 'Article 40', 'MCO')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')',\n           'Use only allowed values ''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS1' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Unique Value Violation',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Duplicate value \"' || invalid_value || '\" found in ' || issue_column,\n           'Ensure each value in column6 is unique'\n      FROM unique_value;\nWITH pattern AS (\n    SELECT 'FACILITY ADDRESS2' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO '^[a-zA-Z0-9\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z0-9\\s]+$',\n           'Follow the pattern ^[a-zA-Z0-9\\s]+$ in ' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'FACILITY STATE' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN ('NY', 'New York')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''NY'', ''New York'')',\n           'Use only allowed values ''NY'', ''New York'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT 'FACILITY ZIP' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO '^\\d{5}(\\d{4})?$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^\\d{5}(\\d{4})?$',\n           'Follow the pattern ^\\d{5}(\\d{4})?$ in ' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_PART_2_FLAG' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OMH_FLAG' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Missing Mandatory Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Mandatory field ' || issue_column || ' is empty',\n           'Provide a value for ' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT 'VISIT_OPWDD_FLAG' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN ('Yes', 'No')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Invalid Value',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' not in allowed list (''Yes'', ''No'')',\n           'Use only allowed values ''Yes'', ''No'' in ' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT 'FACILITY_LONG_NAME' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO '^[a-zA-Z\\s]+$'\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           '05269d28-15ae-5bd6-bd88-f949ccfa52d7',\n           'f6d4aff4-4b71-5662-8f57-00ee247dc57c',\n           'Pattern Mismatch',\n           issue_row,\n           issue_column,\n           invalid_value,\n           'Value ' || invalid_value || ' in ' || issue_column || ' does not match the pattern ^[a-zA-Z\\s]+$',\n           'Follow the pattern ^[a-zA-Z\\s]+$ in ' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('90a0010e-213e-58c3-9302-5e7310006b95', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QeAdminDataExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('97c2cca2-92f5-5937-97e6-d84beeb4018e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('f626602e-8be5-5e8c-824c-bdde91b22817', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'QuestionReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('442b5e69-76fb-5da8-ae00-b79ea50cbedb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'INGESTED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('398104b8-02dc-509b-998a-0b66b5a912e1', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE', 'ASSURED_EXCEL_WORKBOOK_SHEET', NULL, 'AnswerReferenceExcelSheetIngestSource.assuranceSQL', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitResources",
        "exec_code": "duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a26bdb9-1499-515c-aeb4-c6d1d0a20541', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;  \n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Encounter Class Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_class_reference;  \n\nSELECT ''text'' as component, ''Encounter Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_status_code_reference;  \n\nSELECT ''text'' as component, ''Encounter Type Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_type_code_reference;  \n\nSELECT ''text'' as component, ''Screening Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM screening_status_code_reference;  \n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;  \n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;  \n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility_id\n                FROM screening_2_01hpkty3hctk826tvx5tasga55\n            GROUP BY pat_mrn_id, facility_id\n            ORDER BY facility_id;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'') from screening_2_01hpkty3hctk826tvx5tasga55 where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT question, meas_value \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Patient'', first_name, last_name) from demographic_data_2_01hpkty3hctk826tvx5tasga55 where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55_fhir_patient\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Observations'', dmr.first_name, dmr.last_name) from screening_2_01hpkty3hctk826tvx5tasga55 as scr join demographic_data_2_01hpkty3hctk826tvx5tasga55 as dmr on scr.pat_mrn_id = dmr.pat_mrn_id where scr.pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Questionnaire'', dmr.first_name, dmr.last_name) from screening_2_01hpkty3hctk826tvx5tasga55 as scr join demographic_data_2_01hpkty3hctk826tvx5tasga55 as dmr on scr.pat_mrn_id = dmr.pat_mrn_id where scr.pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55_fhir_questionnaire\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'init', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''EXCELSIOR'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', (''2024-02-16T16:13:30.775Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Lvl'': ''VARCHAR'',\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR''\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Worksheet'': ''VARCHAR'',\n      ''Field'': ''VARCHAR'',\n      ''Required'': ''VARCHAR'',\n      ''Permissible Values'': ''VARCHAR'', \n      ''Criteria-1'': ''VARCHAR'',\n      ''Criteria-2'': ''VARCHAR'',\n      ''Criteria-3'': ''VARCHAR'',\n      ''Criteria-4'': ''VARCHAR'',\n      ''Criteria-5'': ''VARCHAR'',\n      ''Criteria-6'': ''VARCHAR'',\n      ''Criteria-7'': ''VARCHAR'',\n      ''Remarks'': ''VARCHAR''\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''SCREENING_CODE'': ''VARCHAR'',\n      ''SCREENING_CODE_DESCRIPTION'': ''VARCHAR'',\n      ''QUESTION'': ''VARCHAR'',\n      ''QUESTION_CODE'': ''VARCHAR'',\n      ''ANSWER_VALUE'': ''VARCHAR'',\n      ''ANSWER_CODE'': ''VARCHAR'',\n      ''SCORE'': ''VARCHAR'',\n      ''UCUM Units'': ''VARCHAR'',\n      ''SDOH_DOMAIN'': ''VARCHAR'',\n      ''POTENTIAL_NEED_INDICATED'': ''VARCHAR'',\n    });\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''EXCELSIOR'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', (''2024-02-16T16:13:30.775Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Lvl'': ''VARCHAR'',\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR''\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Worksheet'': ''VARCHAR'',\n      ''Field'': ''VARCHAR'',\n      ''Required'': ''VARCHAR'',\n      ''Permissible Values'': ''VARCHAR'', \n      ''Criteria-1'': ''VARCHAR'',\n      ''Criteria-2'': ''VARCHAR'',\n      ''Criteria-3'': ''VARCHAR'',\n      ''Criteria-4'': ''VARCHAR'',\n      ''Criteria-5'': ''VARCHAR'',\n      ''Criteria-6'': ''VARCHAR'',\n      ''Criteria-7'': ''VARCHAR'',\n      ''Remarks'': ''VARCHAR''\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''SCREENING_CODE'': ''VARCHAR'',\n      ''SCREENING_CODE_DESCRIPTION'': ''VARCHAR'',\n      ''QUESTION'': ''VARCHAR'',\n      ''QUESTION_CODE'': ''VARCHAR'',\n      ''ANSWER_VALUE'': ''VARCHAR'',\n      ''ANSWER_CODE'': ''VARCHAR'',\n      ''SCORE'': ''VARCHAR'',\n      ''UCUM Units'': ''VARCHAR'',\n      ''SDOH_DOMAIN'': ''VARCHAR'',\n      ''POTENTIAL_NEED_INDICATED'': ''VARCHAR'',\n    });\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('bebf797d-855b-5e76-93d2-2a802febd5a2', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ingest', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''Unknown CSV File Type'', ''CSV file ''''ahc-hrsn-2023-12-12-valid.csv'''' not found in ''''ahc-hrsn-2023-12-12-valid.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''46171763-bd21-57a8-a403-0785f72643cf'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e6951d0b-be59-58c3-8a04-01181208c601'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''screening_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM_NAME''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED''), (''ASSISTANCE_REQUESTED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''demographic_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''80af4eff-d697-565b-9e3f-a587e322b1da'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX _CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX _CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''demographic_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_admin_demographic'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Admin_Demographic'' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''5b77d127-e62a-50a9-acee-bea63ff64dd5'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Admin_Demographic'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADDRESS1''), (''ADDRESS2''), (''ADMINISTRATIVE_SEX''), (''CITY''), (''CONSENT ''), (''ENCOUNTER_ID''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''FACILITY ID (Assigning authority)''), (''FIRST_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_DESCRIPTION''), (''LAST_NAME''), (''MEDICAID_CIN''), (''MIDDLE_NAME''), (''MPI_ID''), (''PAT_BIRTH_DATE''), (''PAT_MRN_ID''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''SEX_AT_BIRTH''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''STATE''), (''ZIP'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_admin_demographic'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4f7e4436-c5f6-5ba1-9793-580ab66789fb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ANSWER_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ASSISTANCE_REQUESTED''), (''FACILITY ID (Assigning authority)''), (''MEAS_VALUE''), (''PARENT_QUESTION_CODE''), (''PAT_MRN_ID''), (''POTENTIAL_NEED_INDICATED''), (''QUESTION_CODE_SYSTEM_NAME''), (''QUESTION_CODE''), (''QUESTION''), (''RECORDED_TIME''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_METHOD''), (''SCREENING_NAME''), (''SDOH_DOMAIN''), (''UCUM_UNITS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_screening.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86ff3ab6-900d-5474-b63c-cbcac3c66f1a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6202ec4a-f3d5-5302-9ed6-9cb59a5b2818'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''QE_Admin_Data'' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''QE_Admin_Data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4b7537b2-9d60-59f3-8c61-fa2ff4265c02'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''657d6337-8d24-5b67-b139-87db6a228264'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_question_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9f13dd7d-9ff8-509d-b716-cde856c5f0f0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Question_Reference'' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''657d6337-8d24-5b67-b139-87db6a228264'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Question_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''QUESTION_CODE''), (''QUESTION''), (''SDOH_DOMAIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_question_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''657d6337-8d24-5b67-b139-87db6a228264'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_question_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c0d34d3-bf09-527a-aef5-85004a400be5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e2816d61-4406-5073-ac60-f129a107d938'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_answer_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''413ec5cd-eee9-5c62-90a5-6670f8b9ddff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Answer_Reference'' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e2816d61-4406-5073-ac60-f129a107d938'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Answer_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''QUESTION_CODE''), (''ANSWER_CODE''), (''MEAS_VALUE'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_answer_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e2816d61-4406-5073-ac60-f129a107d938'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6c48996f-0dd4-572f-b087-e5913926cd4b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''', NULL, '[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''Unknown CSV File Type'', ''CSV file ''''ahc-hrsn-2023-12-12-valid.csv'''' not found in ''''ahc-hrsn-2023-12-12-valid.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''46171763-bd21-57a8-a403-0785f72643cf'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e6951d0b-be59-58c3-8a04-01181208c601'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''screening_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM_NAME''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED''), (''ASSISTANCE_REQUESTED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''demographic_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''80af4eff-d697-565b-9e3f-a587e322b1da'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX _CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX _CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''demographic_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_admin_demographic'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Admin_Demographic'' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''5b77d127-e62a-50a9-acee-bea63ff64dd5'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Admin_Demographic'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADDRESS1''), (''ADDRESS2''), (''ADMINISTRATIVE_SEX''), (''CITY''), (''CONSENT ''), (''ENCOUNTER_ID''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''FACILITY ID (Assigning authority)''), (''FIRST_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_DESCRIPTION''), (''LAST_NAME''), (''MEDICAID_CIN''), (''MIDDLE_NAME''), (''MPI_ID''), (''PAT_BIRTH_DATE''), (''PAT_MRN_ID''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''SEX_AT_BIRTH''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''STATE''), (''ZIP'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_admin_demographic'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4f7e4436-c5f6-5ba1-9793-580ab66789fb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ANSWER_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ASSISTANCE_REQUESTED''), (''FACILITY ID (Assigning authority)''), (''MEAS_VALUE''), (''PARENT_QUESTION_CODE''), (''PAT_MRN_ID''), (''POTENTIAL_NEED_INDICATED''), (''QUESTION_CODE_SYSTEM_NAME''), (''QUESTION_CODE''), (''QUESTION''), (''RECORDED_TIME''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_METHOD''), (''SCREENING_NAME''), (''SDOH_DOMAIN''), (''UCUM_UNITS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_screening.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86ff3ab6-900d-5474-b63c-cbcac3c66f1a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6202ec4a-f3d5-5302-9ed6-9cb59a5b2818'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''QE_Admin_Data'' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''QE_Admin_Data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4b7537b2-9d60-59f3-8c61-fa2ff4265c02'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''657d6337-8d24-5b67-b139-87db6a228264'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_question_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9f13dd7d-9ff8-509d-b716-cde856c5f0f0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Question_Reference'' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''657d6337-8d24-5b67-b139-87db6a228264'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Question_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''QUESTION_CODE''), (''QUESTION''), (''SDOH_DOMAIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_question_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''657d6337-8d24-5b67-b139-87db6a228264'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_question_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c0d34d3-bf09-527a-aef5-85004a400be5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e2816d61-4406-5073-ac60-f129a107d938'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_answer_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''413ec5cd-eee9-5c62-90a5-6670f8b9ddff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Answer_Reference'' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e2816d61-4406-5073-ac60-f129a107d938'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Answer_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''QUESTION_CODE''), (''ANSWER_CODE''), (''MEAS_VALUE'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_answer_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e2816d61-4406-5073-ac60-f129a107d938'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6c48996f-0dd4-572f-b087-e5913926cd4b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n\n```\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('5476830d-6cd9-5866-a105-7049aa24426d', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ensureContent', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c40829eb-7f91-583a-8af8-06de851777a0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5a941253-b661-5282-a5e6-97cbfe5dfb32'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a8ec8b43-9e16-5eeb-9683-bc14288971f1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Encounter Class'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Encounter Class \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Encounter Class Code with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f58ee169-7478-59ca-9e36-aa384ddb501c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''35c62034-5b20-5891-8d38-3e9b051dec6e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''' in '' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX _CODE_DESCRIPTION'' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN (''Yes'',''No'',''Y'',''N'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3cab2329-2aae-5475-9792-04e14e862f1e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH'' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_DESCRIPTION'' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b63bd83d-959a-5a5f-8d60-08b84bf16c90'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8278fd0f-7116-55bd-8d7a-0a30681b0d2f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_NAME'' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_METHOD'' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN (''In-Person'', ''Phone'', ''Website'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''In-Person'''', ''''Phone'''', ''''Website'''')'',\n           ''Use only allowed values ''''In-Person'''', ''''Phone'''', ''''Website'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Screening Question'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Screening Question \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate screening questions with question reference data''\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''47d97ff4-908a-50f7-a2e2-443e2dad7056'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c420c3ba-ddbc-582b-9cdf-361497beb034'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''90a0010e-213e-58c3-9302-5e7310006b95'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''97c2cca2-92f5-5937-97e6-d84beeb4018e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f626602e-8be5-5e8c-824c-bdde91b22817'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''442b5e69-76fb-5da8-ae00-b79ea50cbedb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''398104b8-02dc-509b-998a-0b66b5a912e1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c40829eb-7f91-583a-8af8-06de851777a0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5a941253-b661-5282-a5e6-97cbfe5dfb32'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a8ec8b43-9e16-5eeb-9683-bc14288971f1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Encounter Class'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Encounter Class \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Encounter Class Code with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f58ee169-7478-59ca-9e36-aa384ddb501c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''35c62034-5b20-5891-8d38-3e9b051dec6e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''' in '' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX _CODE_DESCRIPTION'' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN (''Yes'',''No'',''Y'',''N'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3cab2329-2aae-5475-9792-04e14e862f1e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH'' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_DESCRIPTION'' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b63bd83d-959a-5a5f-8d60-08b84bf16c90'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8278fd0f-7116-55bd-8d7a-0a30681b0d2f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_NAME'' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_METHOD'' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN (''In-Person'', ''Phone'', ''Website'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''In-Person'''', ''''Phone'''', ''''Website'''')'',\n           ''Use only allowed values ''''In-Person'''', ''''Phone'''', ''''Website'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Screening Question'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Screening Question \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate screening questions with question reference data''\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''47d97ff4-908a-50f7-a2e2-443e2dad7056'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c420c3ba-ddbc-582b-9cdf-361497beb034'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''90a0010e-213e-58c3-9302-5e7310006b95'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''97c2cca2-92f5-5937-97e6-d84beeb4018e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f626602e-8be5-5e8c-824c-bdde91b22817'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''442b5e69-76fb-5da8-ae00-b79ea50cbedb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''398104b8-02dc-509b-998a-0b66b5a912e1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nATTACH '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('334b7ece-79ec-5ea1-b98b-bb09d0e2b234', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM qe_admin_data_2_01hpkty3hctk826tvx5tasga55;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('397748ba-bd27-56b6-8272-a45f9caeaf64', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0626c65d-bfe1-5eba-8a88-316343d5a123', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.screening_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM screening_2_01hpkty3hctk826tvx5tasga55;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_2_01hpkty3hctk826tvx5tasga55;\n  \n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir_questionnaire AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID \n        ),\n        'authored', RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', QUESTION_CODE,\n                'text', QUESTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', ANSWER_CODE,\n                        'display', MEAS_VALUE\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_2_01hpkty3hctk826tvx5tasga55; \n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('485754a8-39a0-5f12-96bc-6e869590e1e9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6ec2d7d4-0366-56b5-8763-dd9d6361dce0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM demographic_data_2_01hpkty3hctk826tvx5tasga55;\n  \nCREATE VIEW resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55_fhir_patient AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Patient',\n        'identifier', MPI_ID,\n        'active', true,\n        'name', CONCAT(FIRST_NAME,' ', LAST_NAME),\n        'telecom', '',\n        'gender', GENDER_IDENTITY_DESCRIPTION,\n        'birthDate', PAT_BIRTH_DATE,\n        'address', json_array(\n            json_object(\n              'text', ADDRESS1,\n              'line', ADDRESS2,\n              'city', CITY,\n              'state', STATE,\n              'postalCode', ZIP\n          )\n        )\n    ) AS FHIR_Patient\n  FROM demographic_data_2_01hpkty3hctk826tvx5tasga55; \n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('09b84d82-4502-5597-99c1-a190fb056033', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63d56427-0888-5164-bea5-3f122e5805fd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_admin_demographic AS SELECT * FROM ahc_hrsn_2024_01_25_valid_admin_demographic;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1a02c252-e9e3-5a86-8ec9-54e0cb66e62b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2d193f6b-b33f-5f8b-8281-da48e6bceaaf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_screening AS SELECT * FROM ahc_hrsn_2024_01_25_valid_screening;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3392e5a3-5c3e-5fbe-9dc0-08c6b4a4cc99', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d8ecb6e-190a-5c47-b730-41cbb9d35145', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_q_e_admin_data AS SELECT * FROM ahc_hrsn_2024_01_25_valid_q_e_admin_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7b09fc-4ad4-5311-92d1-7c7a0550d0aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('effcdab8-9c23-5403-ac83-f79f6f89b302', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_question_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_question_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ddd5157b-0daf-5a61-bcd3-cda46ece2d09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(QuestionReferenceExcelSheetIngestSource)', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7210b304-8af5-537d-be03-2b8bb421337d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_answer_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_answer_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('841b1d15-81a7-5865-8dee-86f56e93ad92', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AnswerReferenceExcelSheetIngestSource)', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    ;\n\n-- export reference tables from DuckDb into the attached database (nature-dependent)\nCREATE TABLE resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference;\nCREATE TABLE resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference;\nCREATE TABLE resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference;\nCREATE TABLE resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference;\nCREATE TABLE resource_db.business_rules AS SELECT * FROM business_rules;\nCREATE TABLE resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "orch_session_exec_id": "ff91aafa-9001-50c0-980b-5de3eb4b68d7",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a26bdb9-1499-515c-aeb4-c6d1d0a20541', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\n\n-- diagnostics-md-ignore-start \"SQLPage and execution diagnostics SQL DML\"\n-- emit all the SQLPage content\nCREATE TABLE IF NOT EXISTS \"sqlpage_files\" (\n    \"path\" TEXT PRIMARY KEY NOT NULL,\n    \"contents\" TEXT NOT NULL,\n    \"last_modified\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/session_entries.handlebars', '<h1>{{title}}</h1>\n  \n<ul>\n{{#each_row}}\n    <li><a href=\"?session_entry_id={{orch_session_entry_id}}\">{{ingest_src}}</a> ({{ingest_table_name}})</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sqlpage/templates/info_model_schema_tables.handlebars', '{{caption}}\n<ul>\n{{#each_row}}\n    <li><a href=\"?table_nature={{nature}}&table_name={{table_name}}\">{{table_name}}</a> ({{nature}}, {{columns_count}} columns)</li>\n{{/each_row}}\n</ul>', (CURRENT_TIMESTAMP));\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('scripts/shell.js', 'function wrapSTDOUTInDetails() {\n    // Find all heading elements that could contain the STDOUT text\n    const headings = document.querySelectorAll(''h1, h2, h3, h4, h5, h6'');\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n            // Find the next <pre><code> block\n            var nextEl = heading.nextElementSibling;\n            while (nextEl) {\n                if (nextEl.matches(''pre'') && nextEl.querySelector(''code'')) {\n                    // Create the <details> and <summary> elements\n                    const details = document.createElement(''details'');\n                    const summary = document.createElement(''summary'');\n                    summary.textContent = heading.textContent;\n\n                    // Wrap the <pre><code> block in <details>\n                    nextEl.parentNode.insertBefore(details, nextEl);\n                    details.appendChild(summary);\n                    details.appendChild(nextEl);\n                    break;\n                }\n                nextEl = nextEl.nextElementSibling;\n            }\n        }\n    });\n\n    headings.forEach(function(heading) {\n        if (heading.textContent.includes(''STDOUT'')) {\n          heading.remove();\n        }\n    });\n}\n\ndocument.addEventListener(''DOMContentLoaded'', function() {\n  // find all code elements on the current page with the class ''language-sql'' and add the class ''line-numbers'' to each of them\n  document.querySelectorAll(''code.language-sql'').forEach(function(codeEl) {\n      var parentPre = codeEl.parentElement;\n      if (parentPre && parentPre.tagName === ''PRE'') {\n          parentPre.classList.add(''line-numbers'');\n      }\n  });\n  wrapSTDOUTInDetails();\n});\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('index.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''list'' as component;\nSELECT ''1115 Waiver Screenings'' as title,''1115-waiver-screenings.sql'' as link;\nSELECT ''Orchestration Sessions'' as title,''sessions.sql'' as link;\nSELECT ''Orchestration Issues'' as title,''issues.sql'' as link;\nSELECT ''Orchestration State Schema'' as title,''schema.sql'' as link;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('sessions.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component;\nSELECT * FROM device;\n\nSELECT ''table'' as component, ''orch_session_id'' as markdown, ''SUMMARY'' as markdown;\nSELECT ''['' || orch_session_id || ''](session-diagnostics.sql?session_id=''|| orch_session_id ||'')'' as orch_session_id,''['' || ''Summary'' || ''](session-summary.sql?session_id=''|| orch_session_id ||'')'' as SUMMARY, device_id, orch_started_at, orch_finished_at FROM orch_session;  \n\nSELECT ''table'' as component, ''true'' as search, ''ingest_src'' as markdown;\nSELECT ''['' || ingest_src || ''](issues.sql?session_entry_id=''|| orch_session_entry_id ||'')'' as ingest_src, ingest_table_name FROM \"orch_session_entry\";\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('reference.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, ''Encounter Class Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_class_reference;  \n\nSELECT ''text'' as component, ''Encounter Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_status_code_reference;  \n\nSELECT ''text'' as component, ''Encounter Type Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM encounter_type_code_reference;  \n\nSELECT ''text'' as component, ''Screening Status Code Reference'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM screening_status_code_reference;  \n\nSELECT ''text'' as component, ''Business Rules'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM business_rules;  \n\nSELECT ''text'' as component, ''AHC Cross Walk'' as title;\n\nSELECT ''table'' as component;\nSELECT * FROM ahc_cross_walk;  \n\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-diagnostics.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Arguments '') as title, (SELECT ''```json\n'' || args_json || ''\n```'' FROM orch_session WHERE orch_session_id = $session_id) as contents_md;\n\nSELECT ''text'' as component, (''Session '' || $session_id || '' Diagnostics '') as title, (SELECT diagnostics_md FROM orch_session WHERE orch_session_id = $session_id) as contents_md;', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('session-summary.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Summary'' as title;\nSELECT ''table'' as component, ''true'' as search;\nSELECT issue_type,COUNT(orch_session_issue_id) as issue_count from orch_session_issue group by issue_type;\n\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('issues.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''session_entries'' as component, ''Choose Session Entry'' as title;\nSELECT orch_session_entry_id, ingest_src, ingest_table_name \n  FROM orch_session_entry;\n\nSELECT ''table'' as component, ''true'' as search;\n\n            SELECT issue_type, issue_message, invalid_value, remediation\n              FROM orch_session_issue\n             WHERE session_entry_id = $session_entry_id;\n', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('1115-waiver-screenings.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\n\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort, ''pat_mrn_id'' as markdown;\n\n              SELECT format(''[%s](?pat_mrn_id=%s)'', pat_mrn_id, pat_mrn_id) as pat_mrn_id, facility_id\n                FROM screening_2_01hpkty3hctk826tvx5tasga55\n            GROUP BY pat_mrn_id, facility_id\n            ORDER BY facility_id;\n\nSELECT ''text'' as component, (select format(''%s %s Answers'') from screening_2_01hpkty3hctk826tvx5tasga55 where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE coalesce($pat_mrn_id, '''') <> '''';\n\n            SELECT question, meas_value \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Patient'', first_name, last_name) from demographic_data_2_01hpkty3hctk826tvx5tasga55 where pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55_fhir_patient\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Observations'', dmr.first_name, dmr.last_name) from screening_2_01hpkty3hctk826tvx5tasga55 as scr join demographic_data_2_01hpkty3hctk826tvx5tasga55 as dmr on scr.pat_mrn_id = dmr.pat_mrn_id where scr.pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55_fhir\"\n             WHERE pat_mrn_id = $pat_mrn_id;\nSELECT ''text'' as component, (select format(''%s %s FHIR Questionnaire'', dmr.first_name, dmr.last_name) from screening_2_01hpkty3hctk826tvx5tasga55 as scr join demographic_data_2_01hpkty3hctk826tvx5tasga55 as dmr on scr.pat_mrn_id = dmr.pat_mrn_id where scr.pat_mrn_id = $pat_mrn_id) as title;\nSELECT ''table'' as component, ''true'' as search, ''true'' as sort WHERE $pat_mrn_id is not null;\n\n            SELECT * \n              FROM \"screening_2_01hpkty3hctk826tvx5tasga55_fhir_questionnaire\"\n             WHERE pat_mrn_id = $pat_mrn_id;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;\nINSERT INTO \"sqlpage_files\" (\"path\", \"contents\", \"last_modified\") VALUES ('schema.sql', 'SELECT ''dynamic'' AS component, ''{\"component\":\"shell\",\"title\":\"QCS Orchestration Engine\",\"link\":\"/\",\"icon\":\"book\",\"menu_item\":[{\"title\":\"Screenings\",\"link\":\"/1115-waiver-screenings.sql\"},{\"title\":\"Sessions\",\"link\":\"/sessions.sql\"},{\"title\":\"Schema\",\"link\":\"/schema.sql\"},{\"title\":\"Reference\",\"link\":\"/reference.sql\"}],\"javascript\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/prism.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/autoloader/prism-autoloader.min.js\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.min.js\",\"/scripts/shell.js\"],\"css\":[\"https://cdn.jsdelivr.net/npm/prismjs@1/themes/prism-tomorrow.css\",\"https://cdn.jsdelivr.net/npm/prismjs@1/plugins/line-numbers/prism-line-numbers.css\"]}'' AS properties;\nSELECT ''text'' as component, ''Information Model (Schema) Documentation'' as title, ''TODO (description)'' as contents_md;\n\nSELECT ''table'' as component, ''table_name'' as markdown;\n\n          SELECT format(''[%s](?table_name=%s&table_nature)'', m.tbl_name, m.tbl_name, m.type) AS table_name,\n                 (SELECT COUNT(*) FROM sqlite_master sm2 JOIN pragma_table_info(m.tbl_name) cc ON 1=1 WHERE sm2.tbl_name = m.tbl_name) AS columns_count,\n                 m.type as nature\n            FROM sqlite_master m\n        ORDER BY table_name\n      ;\n\nSELECT ''text'' as component, ($table_name || '' '' || $table_nature || '' columns'' ) as title, ''TODO (lineage, governance, description, etc.)'' as contents_md WHERE coalesce($table_name, '''') <> '''';\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT\n              ROW_NUMBER() OVER (PARTITION BY m.tbl_name ORDER BY c.cid) AS column_num,\n              -- TODO: add governance information (e.g. description, etc. from SQLa)\n              CASE WHEN c.pk THEN ''*'' ELSE '''' END AS is_primary_key,\n              c.name AS column_name,\n              c.\"type\" AS column_type,\n              CASE WHEN c.\"notnull\" THEN ''*'' ELSE '''' END AS not_null,\n              COALESCE(c.dflt_value, '''') AS default_value,\n              COALESCE((SELECT pfkl.\"table\" || ''.'' || pfkl.\"to\" FROM pragma_foreign_key_list(m.tbl_name) AS pfkl WHERE pfkl.\"from\" = c.name), '''') as fk_refs\n              -- TODO: add \"is_indexed\" and other details\n            FROM sqlite_master m JOIN pragma_table_info(m.tbl_name) c ON 1=1\n            WHERE m.tbl_name = $table_name;\n\nSELECT ''text'' as component, ($table_name || '' indexes'') as title;\nSELECT ''table'' as component WHERE coalesce($table_name, '''') <> '''';\n\n            SELECT il.name as \"Index Name\", group_concat(ii.name, '', '') as columns\n              FROM sqlite_master as m, pragma_index_list(m.name) AS il, pragma_index_info(il.name) AS ii\n             WHERE m.tbl_name = $table_name\n             GROUP BY m.name, il.name;\n\n-- TODO: add PlantUML or Mermaid ERD through SQL as emitted by tbls (use ChatGPT to create)\n    ;\n    ', (CURRENT_TIMESTAMP)) ON CONFLICT(path) DO UPDATE SET contents = EXCLUDED.contents /* TODO: does not work in DuckDB , last_modified = (CURRENT_TIMESTAMP) */;;\n\n-- emit all the execution diagnostics\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('168a34c7-d043-5ec4-a84a-c961f1a301ef', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'init', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''EXCELSIOR'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', (''2024-02-16T16:13:30.775Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Lvl'': ''VARCHAR'',\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR''\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Worksheet'': ''VARCHAR'',\n      ''Field'': ''VARCHAR'',\n      ''Required'': ''VARCHAR'',\n      ''Permissible Values'': ''VARCHAR'', \n      ''Criteria-1'': ''VARCHAR'',\n      ''Criteria-2'': ''VARCHAR'',\n      ''Criteria-3'': ''VARCHAR'',\n      ''Criteria-4'': ''VARCHAR'',\n      ''Criteria-5'': ''VARCHAR'',\n      ''Criteria-6'': ''VARCHAR'',\n      ''Criteria-7'': ''VARCHAR'',\n      ''Remarks'': ''VARCHAR''\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''SCREENING_CODE'': ''VARCHAR'',\n      ''SCREENING_CODE_DESCRIPTION'': ''VARCHAR'',\n      ''QUESTION'': ''VARCHAR'',\n      ''QUESTION_CODE'': ''VARCHAR'',\n      ''ANSWER_VALUE'': ''VARCHAR'',\n      ''ANSWER_CODE'': ''VARCHAR'',\n      ''SCORE'': ''VARCHAR'',\n      ''UCUM Units'': ''VARCHAR'',\n      ''SDOH_DOMAIN'': ''VARCHAR'',\n      ''POTENTIAL_NEED_INDICATED'': ''VARCHAR'',\n    });\n\n-- no after-init SQL found', NULL, NULL, NULL, '\n## init\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n\n-- no before-init SQL found\nCREATE TABLE IF NOT EXISTS \"device\" (\n    \"device_id\" TEXT PRIMARY KEY NOT NULL,\n    \"name\" TEXT NOT NULL,\n    \"state\" TEXT NOT NULL,\n    \"boundary\" TEXT NOT NULL,\n    \"segmentation\" TEXT,\n    \"state_sysinfo\" TEXT,\n    \"elaboration\" TEXT,\n    UNIQUE(\"name\", \"state\", \"boundary\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session\" (\n    \"orch_session_id\" TEXT PRIMARY KEY NOT NULL,\n    \"device_id\" TEXT NOT NULL,\n    \"orch_started_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"orch_finished_at\" TIMESTAMP,\n    \"elaboration\" TEXT,\n    \"args_json\" TEXT,\n    \"diagnostics_json\" TEXT,\n    \"diagnostics_md\" TEXT,\n    FOREIGN KEY(\"device_id\") REFERENCES \"device\"(\"device_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_entry\" (\n    \"orch_session_entry_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"ingest_src\" TEXT NOT NULL,\n    \"ingest_table_name\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_state\" (\n    \"orch_session_state_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"from_state\" TEXT NOT NULL,\n    \"to_state\" TEXT NOT NULL,\n    \"transition_result\" TEXT,\n    \"transition_reason\" TEXT,\n    \"transitioned_at\" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    UNIQUE(\"orch_session_state_id\", \"from_state\", \"to_state\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_exec\" (\n    \"orch_session_exec_id\" TEXT PRIMARY KEY NOT NULL,\n    \"exec_nature\" TEXT NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"parent_exec_id\" TEXT,\n    \"namespace\" TEXT,\n    \"exec_identity\" TEXT,\n    \"exec_code\" TEXT NOT NULL,\n    \"exec_status\" INTEGER NOT NULL,\n    \"input_text\" TEXT,\n    \"exec_error_text\" TEXT,\n    \"output_text\" TEXT,\n    \"output_nature\" TEXT,\n    \"narrative_md\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\"),\n    FOREIGN KEY(\"parent_exec_id\") REFERENCES \"orch_session_exec\"(\"orch_session_exec_id\")\n);\nCREATE TABLE IF NOT EXISTS \"orch_session_issue\" (\n    \"orch_session_issue_id\" TEXT PRIMARY KEY NOT NULL,\n    \"session_id\" TEXT NOT NULL,\n    \"session_entry_id\" TEXT,\n    \"issue_type\" TEXT NOT NULL,\n    \"issue_message\" TEXT NOT NULL,\n    \"issue_row\" INTEGER,\n    \"issue_column\" TEXT,\n    \"invalid_value\" TEXT,\n    \"remediation\" TEXT,\n    \"elaboration\" TEXT,\n    FOREIGN KEY(\"session_id\") REFERENCES \"orch_session\"(\"orch_session_id\"),\n    FOREIGN KEY(\"session_entry_id\") REFERENCES \"orch_session_entry\"(\"orch_session_entry_id\")\n);\nCREATE INDEX IF NOT EXISTS \"idx_device__name__state\" ON \"device\"(\"name\", \"state\");\n\nDROP VIEW IF EXISTS \"orch_session_diagnostic_text\";\nCREATE VIEW IF NOT EXISTS \"orch_session_diagnostic_text\" AS\n    SELECT\n        -- Including all other columns from ''orch_session''\n        ises.* EXCLUDE (orch_started_at, orch_finished_at),\n        -- TODO: Casting known timestamp columns to text so emit to Excel works with GDAL (spatial)\n           -- strftime(timestamptz orch_started_at, ''%Y-%m-%d %H:%M:%S'') AS orch_started_at,\n           -- strftime(timestamptz orch_finished_at, ''%Y-%m-%d %H:%M:%S'') AS orch_finished_at,\n    \n        -- Including all columns from ''orch_session_entry''\n        isee.* EXCLUDE (session_id),\n    \n        -- Including all other columns from ''orch_session_issue''\n        isi.* EXCLUDE (session_id, session_entry_id)\n    FROM orch_session AS ises\n    JOIN orch_session_entry AS isee ON ises.orch_session_id = isee.session_id\n    LEFT JOIN orch_session_issue AS isi ON isee.orch_session_entry_id = isi.session_entry_id;\n\n-- register the current device and session and use the identifiers for all logging\nINSERT INTO \"device\" (\"device_id\", \"name\", \"state\", \"boundary\", \"segmentation\", \"state_sysinfo\", \"elaboration\") VALUES (''7bab389e-54af-5a13-a39f-079abdc73a48'', ''EXCELSIOR'', ''SINGLETON'', ''UNKNOWN'', NULL, ''{\"os-arch\":\"x64\",\"os-platform\":\"linux\"}'', NULL) ON CONFLICT DO NOTHING;\nINSERT INTO \"orch_session\" (\"orch_session_id\", \"device_id\", \"orch_started_at\", \"orch_finished_at\", \"elaboration\", \"args_json\", \"diagnostics_json\", \"diagnostics_md\") VALUES (''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7bab389e-54af-5a13-a39f-079abdc73a48'', (''2024-02-16T16:13:30.775Z''), NULL, NULL, NULL, NULL, ''Session 05269d28-15ae-5bd6-bd88-f949ccfa52d7 markdown diagnostics not provided (not completed?)'');\n\n-- Load Reference data from csvs\nCREATE TABLE encounter_class_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-class-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE screening_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/screening-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Lvl'': ''VARCHAR'',\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_status_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-status-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''Display'': ''VARCHAR'',\n      ''Definition'': ''VARCHAR''\n    });\n\nCREATE TABLE encounter_type_code_reference AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/encounter-type-code-reference.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Code'': ''VARCHAR'',\n      ''System'': ''VARCHAR'',\n      ''Display'': ''VARCHAR''\n    });\n\nCREATE TABLE business_rules AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/business-rules.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''Worksheet'': ''VARCHAR'',\n      ''Field'': ''VARCHAR'',\n      ''Required'': ''VARCHAR'',\n      ''Permissible Values'': ''VARCHAR'', \n      ''Criteria-1'': ''VARCHAR'',\n      ''Criteria-2'': ''VARCHAR'',\n      ''Criteria-3'': ''VARCHAR'',\n      ''Criteria-4'': ''VARCHAR'',\n      ''Criteria-5'': ''VARCHAR'',\n      ''Criteria-6'': ''VARCHAR'',\n      ''Criteria-7'': ''VARCHAR'',\n      ''Remarks'': ''VARCHAR''\n    });\n\nCREATE TABLE ahc_cross_walk AS \n  SELECT * FROM read_csv_auto(''/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/src/ahc-hrsn-elt/reference-data/ahc-cross-walk.csv'',\n    delim = '','',\n    header = true,\n    columns = {\n      ''SCREENING_CODE'': ''VARCHAR'',\n      ''SCREENING_CODE_DESCRIPTION'': ''VARCHAR'',\n      ''QUESTION'': ''VARCHAR'',\n      ''QUESTION_CODE'': ''VARCHAR'',\n      ''ANSWER_VALUE'': ''VARCHAR'',\n      ''ANSWER_CODE'': ''VARCHAR'',\n      ''SCORE'': ''VARCHAR'',\n      ''UCUM Units'': ''VARCHAR'',\n      ''SDOH_DOMAIN'': ''VARCHAR'',\n      ''POTENTIAL_NEED_INDICATED'': ''VARCHAR'',\n    });\n\n-- no after-init SQL found\n```\nNo STDOUT emitted by `init` (status: `0`).\n\nNo STDERR emitted by `init`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('bebf797d-855b-5e76-93d2-2a802febd5a2', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ingest', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb --json', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''Unknown CSV File Type'', ''CSV file ''''ahc-hrsn-2023-12-12-valid.csv'''' not found in ''''ahc-hrsn-2023-12-12-valid.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''46171763-bd21-57a8-a403-0785f72643cf'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e6951d0b-be59-58c3-8a04-01181208c601'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''screening_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM_NAME''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED''), (''ASSISTANCE_REQUESTED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''demographic_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''80af4eff-d697-565b-9e3f-a587e322b1da'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX _CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX _CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''demographic_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_admin_demographic'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Admin_Demographic'' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''5b77d127-e62a-50a9-acee-bea63ff64dd5'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Admin_Demographic'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADDRESS1''), (''ADDRESS2''), (''ADMINISTRATIVE_SEX''), (''CITY''), (''CONSENT ''), (''ENCOUNTER_ID''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''FACILITY ID (Assigning authority)''), (''FIRST_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_DESCRIPTION''), (''LAST_NAME''), (''MEDICAID_CIN''), (''MIDDLE_NAME''), (''MPI_ID''), (''PAT_BIRTH_DATE''), (''PAT_MRN_ID''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''SEX_AT_BIRTH''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''STATE''), (''ZIP'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_admin_demographic'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4f7e4436-c5f6-5ba1-9793-580ab66789fb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ANSWER_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ASSISTANCE_REQUESTED''), (''FACILITY ID (Assigning authority)''), (''MEAS_VALUE''), (''PARENT_QUESTION_CODE''), (''PAT_MRN_ID''), (''POTENTIAL_NEED_INDICATED''), (''QUESTION_CODE_SYSTEM_NAME''), (''QUESTION_CODE''), (''QUESTION''), (''RECORDED_TIME''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_METHOD''), (''SCREENING_NAME''), (''SDOH_DOMAIN''), (''UCUM_UNITS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_screening.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86ff3ab6-900d-5474-b63c-cbcac3c66f1a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6202ec4a-f3d5-5302-9ed6-9cb59a5b2818'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''QE_Admin_Data'' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''QE_Admin_Data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4b7537b2-9d60-59f3-8c61-fa2ff4265c02'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''657d6337-8d24-5b67-b139-87db6a228264'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_question_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9f13dd7d-9ff8-509d-b716-cde856c5f0f0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Question_Reference'' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''657d6337-8d24-5b67-b139-87db6a228264'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Question_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''QUESTION_CODE''), (''QUESTION''), (''SDOH_DOMAIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_question_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''657d6337-8d24-5b67-b139-87db6a228264'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_question_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c0d34d3-bf09-527a-aef5-85004a400be5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e2816d61-4406-5073-ac60-f129a107d938'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_answer_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''413ec5cd-eee9-5c62-90a5-6670f8b9ddff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Answer_Reference'' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e2816d61-4406-5073-ac60-f129a107d938'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Answer_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''QUESTION_CODE''), (''ANSWER_CODE''), (''MEAS_VALUE'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_answer_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e2816d61-4406-5073-ac60-f129a107d938'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6c48996f-0dd4-572f-b087-e5913926cd4b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''', NULL, '[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n', 'JSON', '\n## ingest\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''7b979b68-7227-53fd-b689-e4fe153afb76'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8b7c669c-1795-5f6b-8f3a-3e502b74c628'', ''Unknown CSV File Type'', ''CSV file ''''ahc-hrsn-2023-12-12-valid.csv'''' not found in ''''ahc-hrsn-2023-12-12-valid.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''641dff51-97fd-56b3-8443-c1ed568a6d66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''abf5c680-a135-5d89-b871-fa5b9b99aed6'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''47277588-99e8-59f5-8384-b24344a86073'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d70a4700-6b40-52fc-a7a2-69ef0d7f69ff'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''58b22e99-5854-53bf-adbe-08e67df99b85'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a26ce332-3ced-5623-861d-23a2ef78e4a9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''58b22e99-5854-53bf-adbe-08e67df99b85'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''ae477ba1-c7f1-5f34-847a-50bddb7130aa'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''bc0c03b5-d1ba-5301-850f-5e4c42c1bf09'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'''' (available: JRCHC_SDOH HEL_Report 2452_ran )'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (qe_admin_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''591191c7-f693-5957-8734-ac87151ca981'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/QE_ADMIN_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''qe_admin_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in qe_admin_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure qe_admin_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3b4eb0e5-6239-537a-8e67-e50e172e72a2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''86b4a49e-7378-5159-9f41-b005208c31bc'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''071f8fe1-4899-5c71-9c86-7d7377661d45'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''a3fe7098-8ae8-5612-81ac-cbe10780c19b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''a530fe1b-57ef-5a90-8bea-835ece2483da'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''ahc-hrsn-2023-12-25-valid.xlsx'''' (available: Admin_Demographic, Screening, QE_Admin_Data)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''e36daa69-3c63-5384-b6a7-03fa3b00641d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''99e72a60-96ab-5ef1-a3af-3e7759777664'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c60cf3db-b1bf-5103-b278-b0c128ce924a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''89f7ec04-277a-5799-afaa-a70d0f2a8ed5'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''b10e248d-8c94-59ec-83fc-a1249dd3b111'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''fa7874f6-f848-572b-a9ab-9db4c8d5e959'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5222b730-9add-5b52-b0c9-6f2506b0af9d'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''3252fee6-3a9a-5f4c-81c6-739201046d79'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''c302047e-21cf-5059-a32c-e81a9bd3a9b9'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''jrchc-hrsn-file-spec.xlsx'''' (available: Original Report, HeL LOINC Mapping)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''9860873a-c387-5d98-9930-4ff296eb7192'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''78d6a904-035e-54ae-8ac2-ca5cdf3f75f7'', ''Sheet Missing'', ''Excel workbook sheet ''''Admin_Demographic'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''46171763-bd21-57a8-a403-0785f72643cf'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c'', ''Sheet Missing'', ''Excel workbook sheet ''''Screening'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''c2c0cbca-70cb-54f6-9dc7-66b47c4f3157'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''4971a2f5-06a3-5898-823d-364145d3b9a5'', ''Sheet Missing'', ''Excel workbook sheet ''''QE_Admin_Data'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''544998d3-58c5-5f65-9dc8-9f998508495f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''8640a4b5-53ef-506e-bcde-83f00315d4b2'', ''Sheet Missing'', ''Excel workbook sheet ''''Question_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''10d0290c-b2eb-581e-b627-b5b8fcbb830f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0adb81bc-3df2-5f86-99cc-2d20e1dd5efd'', ''Sheet Missing'', ''Excel workbook sheet ''''Answer_Reference'''' not found in ''''synthetic-fail-excel-01.xlsx'''' (available: Sheet1)'', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv (ERROR)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e6951d0b-be59-58c3-8a04-01181208c601'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', ''ERROR'', NULL);\nINSERT INTO \"orch_session_issue\" (\"orch_session_issue_id\", \"session_id\", \"session_entry_id\", \"issue_type\", \"issue_message\", \"issue_row\", \"issue_column\", \"invalid_value\", \"remediation\", \"elaboration\") VALUES (''2afb3098-bcfd-5a54-8ebb-4d65d399c55e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e6951d0b-be59-58c3-8a04-01181208c601'', ''Unknown CSV File Type'', ''CSV file ''''synthetic-fail.csv'''' not found in ''''synthetic-fail.csv'''''', NULL, NULL, ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv'', NULL, NULL);\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv (screening_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''screening_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''e8b3dab4-5058-5c79-8088-45b423119149'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE screening_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/SCREENING-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY_ID''), (''ENCOUNTER_ID''), (''ENCOUNTER_CLASS_CODE_SYSTEM''), (''ENCOUNTER_CLASS_CODE''), (''ENCOUNTER_CLASS_CODE_DESCRIPTION''), (''ENCOUNTER_STATUS_CODE_SYSTEM''), (''ENCOUNTER_STATUS_CODE''), (''ENCOUNTER_STATUS_CODE_DESCRIPTION''), (''ENCOUNTER_TYPE_CODE_SYSTEM_NAME''), (''ENCOUNTER_TYPE_CODE''), (''ENCOUNTER_TYPE_CODE_DESCRIPTION''), (''SCREENING_CODE_DESCRIPTION''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_STATUS_CODE_DESCRIPTION''), (''SCREENING_STATUS_CODE''), (''SCREENING_STATUS_CODE_SYSTEM''), (''RECORDED_TIME''), (''QUESTION''), (''MEAS_VALUE''), (''UCUM_UNITS''), (''QUESTION_CODE''), (''QUESTION_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ANSWER_CODE_SYSTEM_NAME''), (''PARENT_QUESTION_CODE''), (''SDOH_DOMAIN''), (''POTENTIAL_NEED_INDICATED''), (''ASSISTANCE_REQUESTED'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''screening_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in screening_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure screening_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9dabd022-4a26-55f2-98f4-e534e7704b23'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''ScreeningCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv (demographic_data_2_01hpkty3hctk826tvx5tasga55)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''80af4eff-d697-565b-9e3f-a587e322b1da'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'', ''demographic_data_2_01hpkty3hctk826tvx5tasga55'', NULL);\n\n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6fcd9df5-34cf-5c09-8fb5-e73617e28d73'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ENTER(ingest)'', ''ATTEMPT_CSV_INGEST'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE demographic_data_2_01hpkty3hctk826tvx5tasga55 AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''80af4eff-d697-565b-9e3f-a587e322b1da'' as session_entry_id\n    FROM read_csv_auto(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/DEMOGRAPHIC_DATA-2_01HPKTY3HCTK826TVX5TASGA55.csv'');\n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''MPI_ID''), (''PAT_MRN_ID''), (''FACILITY_ID''), (''CONSENT''), (''FIRST_NAME''), (''MIDDLE_NAME''), (''LAST_NAME''), (''ADMINISTRATIVE_SEX_CODE''), (''ADMINISTRATIVE_SEX _CODE_DESCRIPTION''), (''ADMINISTRATIVE_SEX _CODE_SYSTEM''), (''SEX_AT_BIRTH_CODE''), (''SEX_AT_BIRTH_CODE_DESCRIPTION''), (''SEX_AT_BIRTH_CODE_SYSTEM''), (''PAT_BIRTH_DATE''), (''ADDRESS1''), (''ADDRESS2''), (''CITY''), (''STATE''), (''ZIP''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_DESCRIPTION''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''MEDICAID_CIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''demographic_data_2_01hpkty3hctk826tvx5tasga55'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in demographic_data_2_01hpkty3hctk826tvx5tasga55.'',\n           ''Ensure demographic_data_2_01hpkty3hctk826tvx5tasga55 contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''7e65e3a7-4415-55f4-866b-3b0cc4e85fc6'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_INGEST'', ''INGESTED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_admin_demographic)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_admin_demographic'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a92a6466-6fe4-58d7-8948-e2e09dc2fec2'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Admin_Demographic'' into ahc_hrsn_2024_01_25_valid_admin_demographic using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_admin_demographic AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''5b77d127-e62a-50a9-acee-bea63ff64dd5'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Admin_Demographic'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ADDRESS1''), (''ADDRESS2''), (''ADMINISTRATIVE_SEX''), (''CITY''), (''CONSENT ''), (''ENCOUNTER_ID''), (''ETHNICITY_CODE''), (''ETHNICITY_CODE_DESCRIPTION''), (''ETHNICITY_CODE_SYSTEM_NAME''), (''FACILITY ID (Assigning authority)''), (''FIRST_NAME''), (''GENDER_IDENTITY_CODE''), (''GENDER_IDENTITY_CODE_SYSTEM_NAME''), (''GENDER_IDENTITY_DESCRIPTION''), (''LAST_NAME''), (''MEDICAID_CIN''), (''MIDDLE_NAME''), (''MPI_ID''), (''PAT_BIRTH_DATE''), (''PAT_MRN_ID''), (''PREFERRED_LANGUAGE_CODE''), (''PREFERRED_LANGUAGE_CODE_SYSTEM_NAME''), (''PREFERRED_LANGUAGE_DESCRIPTION''), (''RACE_CODE''), (''RACE_CODE_DESCRIPTION''), (''RACE_CODE_SYSTEM_NAME''), (''SEX_AT_BIRTH''), (''SEXUAL_ORIENTATION_CODE''), (''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME''), (''SEXUAL_ORIENTATION_DESCRIPTION''), (''STATE''), (''ZIP'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_admin_demographic'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_admin_demographic.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_admin_demographic contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''34e90086-3d06-5b10-972d-7d0b40a02289'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_screening)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_screening'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4f7e4436-c5f6-5ba1-9793-580ab66789fb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Screening'' into ahc_hrsn_2024_01_25_valid_screening using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_screening AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Screening'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''ANSWER_CODE_SYSTEM_NAME''), (''ANSWER_CODE''), (''ASSISTANCE_REQUESTED''), (''FACILITY ID (Assigning authority)''), (''MEAS_VALUE''), (''PARENT_QUESTION_CODE''), (''PAT_MRN_ID''), (''POTENTIAL_NEED_INDICATED''), (''QUESTION_CODE_SYSTEM_NAME''), (''QUESTION_CODE''), (''QUESTION''), (''RECORDED_TIME''), (''SCREENING_CODE_SYSTEM_NAME''), (''SCREENING_CODE''), (''SCREENING_METHOD''), (''SCREENING_NAME''), (''SDOH_DOMAIN''), (''UCUM_UNITS'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_screening'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_screening.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_screening contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''86ff3ab6-900d-5474-b63c-cbcac3c66f1a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_q_e_admin_data)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6202ec4a-f3d5-5302-9ed6-9cb59a5b2818'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''QE_Admin_Data'' into ahc_hrsn_2024_01_25_valid_q_e_admin_data using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_q_e_admin_data AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''QE_Admin_Data'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''PAT_MRN_ID''), (''FACILITY ID (Assigning authority)''), (''FACILITY_LONG_NAME''), (''ORGANIZATION_TYPE''), (''FACILITY ADDRESS1''), (''FACILITY ADDRESS2''), (''FACILITY CITY''), (''FACILITY STATE''), (''FACILITY ZIP''), (''VISIT_PART_2_FLAG''), (''VISIT_OMH_FLAG''), (''VISIT_OPWDD_FLAG'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_q_e_admin_data'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_q_e_admin_data.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_q_e_admin_data contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''4b7537b2-9d60-59f3-8c61-fa2ff4265c02'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_question_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''657d6337-8d24-5b67-b139-87db6a228264'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_question_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9f13dd7d-9ff8-509d-b716-cde856c5f0f0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Question_Reference'' into ahc_hrsn_2024_01_25_valid_question_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_question_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''657d6337-8d24-5b67-b139-87db6a228264'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Question_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''SCREENING_CODE''), (''QUESTION_CODE''), (''QUESTION''), (''SDOH_DOMAIN'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_question_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''657d6337-8d24-5b67-b139-87db6a228264'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_question_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_question_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''9c0d34d3-bf09-527a-aef5-85004a400be5'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx (ahc_hrsn_2024_01_25_valid_answer_reference)\n-- required by IngestEngine, setup the ingestion entry for logging\nINSERT INTO \"orch_session_entry\" (\"orch_session_entry_id\", \"session_id\", \"ingest_src\", \"ingest_table_name\", \"elaboration\") VALUES (''e2816d61-4406-5073-ac60-f129a107d938'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', ''ahc_hrsn_2024_01_25_valid_answer_reference'', NULL);\n     \n-- state management diagnostics \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''413ec5cd-eee9-5c62-90a5-6670f8b9ddff'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ENTER(ingest)'', ''ATTEMPT_EXCEL_INGEST'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\n-- ingest Excel workbook sheet ''Answer_Reference'' into ahc_hrsn_2024_01_25_valid_answer_reference using spatial plugin\nINSTALL spatial; LOAD spatial;\n\n-- be sure to add src_file_row_number and session_id columns to each row\n-- because assurance CTEs require them\nCREATE TABLE ahc_hrsn_2024_01_25_valid_answer_reference AS\n  SELECT *, row_number() OVER () as src_file_row_number, ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'' as session_id, ''e2816d61-4406-5073-ac60-f129a107d938'' as session_entry_id\n    FROM st_read(''support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2024-01-25-valid.xlsx'', layer=''Answer_Reference'', open_options=[''HEADERS=FORCE'', ''FIELD_TYPES=AUTO'']);          \n\nWITH required_column_names_in_src AS (\n    SELECT column_name\n      FROM (VALUES (''QUESTION_CODE''), (''ANSWER_CODE''), (''MEAS_VALUE'')) AS required(column_name)\n     WHERE required.column_name NOT IN (\n         SELECT column_name\n           FROM information_schema.columns\n          WHERE table_name = ''ahc_hrsn_2024_01_25_valid_answer_reference'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''e2816d61-4406-5073-ac60-f129a107d938'',\n           ''Missing Column'',\n           ''Required column '' || column_name || '' is missing in ahc_hrsn_2024_01_25_valid_answer_reference.'',\n           ''Ensure ahc_hrsn_2024_01_25_valid_answer_reference contains the column \"'' || column_name || ''\"''\n      FROM required_column_names_in_src;\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''6c48996f-0dd4-572f-b087-e5913926cd4b'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_INGEST'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.ingestSQL'', (CURRENT_TIMESTAMP), NULL);\n\nSELECT session_entry_id, orch_session_issue_id, issue_type, issue_message, invalid_value FROM orch_session_issue WHERE session_id = ''05269d28-15ae-5bd6-bd88-f949ccfa52d7''\n```\n### `ingest` STDOUT (status: `0`)\n```json\n[{\"session_entry_id\":\"8b7c669c-1795-5f6b-8f3a-3e502b74c628\",\"orch_session_issue_id\":\"7b979b68-7227-53fd-b689-e4fe153afb76\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''ahc-hrsn-2023-12-12-valid.csv'' not found in ''ahc-hrsn-2023-12-12-valid.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-12-valid.csv\"},\n{\"session_entry_id\":\"abf5c680-a135-5d89-b871-fa5b9b99aed6\",\"orch_session_issue_id\":\"641dff51-97fd-56b3-8443-c1ed568a6d66\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"d70a4700-6b40-52fc-a7a2-69ef0d7f69ff\",\"orch_session_issue_id\":\"47277588-99e8-59f5-8384-b24344a86073\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"58b22e99-5854-53bf-adbe-08e67df99b85\",\"orch_session_issue_id\":\"a26ce332-3ced-5623-861d-23a2ef78e4a9\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"bc0c03b5-d1ba-5301-850f-5e4c42c1bf09\",\"orch_session_issue_id\":\"ae477ba1-c7f1-5f34-847a-50bddb7130aa\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"8aad9cfa-b1a2-5fb1-a6ab-613a79a7e839\",\"orch_session_issue_id\":\"b41ccd27-9a4f-5cc8-9c5d-b55242d90fb0\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx'' (available: JRCHC_SDOH HEL_Report 2452_ran )\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/JRCHC_SDOH HEL_Report 2452_ran 020124DeIdent.xlsx\"},\n{\"session_entry_id\":\"071f8fe1-4899-5c71-9c86-7d7377661d45\",\"orch_session_issue_id\":\"86b4a49e-7378-5159-9f41-b005208c31bc\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"a530fe1b-57ef-5a90-8bea-835ece2483da\",\"orch_session_issue_id\":\"a3fe7098-8ae8-5612-81ac-cbe10780c19b\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''ahc-hrsn-2023-12-25-valid.xlsx'' (available: Admin_Demographic, Screening, QE_Admin_Data)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/ahc-hrsn-2023-12-25-valid.xlsx\"},\n{\"session_entry_id\":\"99e72a60-96ab-5ef1-a3af-3e7759777664\",\"orch_session_issue_id\":\"e36daa69-3c63-5384-b6a7-03fa3b00641d\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"89f7ec04-277a-5799-afaa-a70d0f2a8ed5\",\"orch_session_issue_id\":\"c60cf3db-b1bf-5103-b278-b0c128ce924a\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"b2a7c7e8-5ffe-5f28-8112-4eb7abb6397f\",\"orch_session_issue_id\":\"b10e248d-8c94-59ec-83fc-a1249dd3b111\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"5222b730-9add-5b52-b0c9-6f2506b0af9d\",\"orch_session_issue_id\":\"fa7874f6-f848-572b-a9ab-9db4c8d5e959\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"c302047e-21cf-5059-a32c-e81a9bd3a9b9\",\"orch_session_issue_id\":\"3252fee6-3a9a-5f4c-81c6-739201046d79\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''jrchc-hrsn-file-spec.xlsx'' (available: Original Report, HeL LOINC Mapping)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/jrchc-hrsn-file-spec.xlsx\"},\n{\"session_entry_id\":\"78d6a904-035e-54ae-8ac2-ca5cdf3f75f7\",\"orch_session_issue_id\":\"9860873a-c387-5d98-9930-4ff296eb7192\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Admin_Demographic'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"d5d6e25d-81b4-5f98-8b91-ea2dbc155a9c\",\"orch_session_issue_id\":\"46171763-bd21-57a8-a403-0785f72643cf\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Screening'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"4971a2f5-06a3-5898-823d-364145d3b9a5\",\"orch_session_issue_id\":\"c2c0cbca-70cb-54f6-9dc7-66b47c4f3157\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''QE_Admin_Data'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"8640a4b5-53ef-506e-bcde-83f00315d4b2\",\"orch_session_issue_id\":\"544998d3-58c5-5f65-9dc8-9f998508495f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Question_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"0adb81bc-3df2-5f86-99cc-2d20e1dd5efd\",\"orch_session_issue_id\":\"10d0290c-b2eb-581e-b627-b5b8fcbb830f\",\"issue_type\":\"Sheet Missing\",\"issue_message\":\"Excel workbook sheet ''Answer_Reference'' not found in ''synthetic-fail-excel-01.xlsx'' (available: Sheet1)\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail-excel-01.xlsx\"},\n{\"session_entry_id\":\"e6951d0b-be59-58c3-8a04-01181208c601\",\"orch_session_issue_id\":\"2afb3098-bcfd-5a54-8ebb-4d65d399c55e\",\"issue_type\":\"Unknown CSV File Type\",\"issue_message\":\"CSV file ''synthetic-fail.csv'' not found in ''synthetic-fail.csv''\",\"invalid_value\":\"support/assurance/ahc-hrsn-elt/screening/synthetic-content/synthetic-fail.csv\"}]\n\n```\nNo STDERR emitted by `ingest`.\n\n    ', NULL);\nINSERT INTO \"orch_session_exec\" (\"orch_session_exec_id\", \"exec_nature\", \"session_id\", \"session_entry_id\", \"parent_exec_id\", \"namespace\", \"exec_identity\", \"exec_code\", \"exec_status\", \"input_text\", \"exec_error_text\", \"output_text\", \"output_nature\", \"narrative_md\", \"elaboration\") VALUES ('5476830d-6cd9-5866-a105-7049aa24426d', 'duckdb', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, NULL, NULL, 'ensureContent', 'duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb', 0, '-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c40829eb-7f91-583a-8af8-06de851777a0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5a941253-b661-5282-a5e6-97cbfe5dfb32'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a8ec8b43-9e16-5eeb-9683-bc14288971f1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Encounter Class'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Encounter Class \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Encounter Class Code with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f58ee169-7478-59ca-9e36-aa384ddb501c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''35c62034-5b20-5891-8d38-3e9b051dec6e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''' in '' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX _CODE_DESCRIPTION'' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN (''Yes'',''No'',''Y'',''N'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3cab2329-2aae-5475-9792-04e14e862f1e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH'' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_DESCRIPTION'' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b63bd83d-959a-5a5f-8d60-08b84bf16c90'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8278fd0f-7116-55bd-8d7a-0a30681b0d2f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_NAME'' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_METHOD'' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN (''In-Person'', ''Phone'', ''Website'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''In-Person'''', ''''Phone'''', ''''Website'''')'',\n           ''Use only allowed values ''''In-Person'''', ''''Phone'''', ''''Website'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Screening Question'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Screening Question \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate screening questions with question reference data''\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''47d97ff4-908a-50f7-a2e2-443e2dad7056'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c420c3ba-ddbc-582b-9cdf-361497beb034'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''90a0010e-213e-58c3-9302-5e7310006b95'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''97c2cca2-92f5-5937-97e6-d84beeb4018e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f626602e-8be5-5e8c-824c-bdde91b22817'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''442b5e69-76fb-5da8-ae00-b79ea50cbedb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''398104b8-02dc-509b-998a-0b66b5a912e1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    ', NULL, NULL, NULL, '\n## ensureContent\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c40829eb-7f91-583a-8af8-06de851777a0'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"qe_admin_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''5a941253-b661-5282-a5e6-97cbfe5dfb32'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''QeAdminDataCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''a8ec8b43-9e16-5eeb-9683-bc14288971f1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SCREENING_CODE\" NOT IN (''96777-8'', ''97023-6'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''96777-8'''', ''''97023-6'''')'',\n           ''Use only allowed values ''''96777-8'''', ''''97023-6'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_encounter_class_in_all_rows AS (\n    SELECT ''ENCOUNTER_CLASS_CODE'' AS issue_column,\n           sr.\"ENCOUNTER_CLASS_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM screening_2_01hpkty3hctk826tvx5tasga55 sr\n      LEFT JOIN encounter_class_reference ecr\n      ON sr.ENCOUNTER_CLASS_CODE = ecr.Code         \n     WHERE sr.ENCOUNTER_CLASS_CODE IS NOT NULL\n      AND ecr.Code IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Encounter Class'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Encounter Class \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate Encounter Class Code with encounter class reference data''\n      FROM valid_encounter_class_in_all_rows;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"screening_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\n    \n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f58ee169-7478-59ca-9e36-aa384ddb501c'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''0e074bf2-f1fe-55d4-bd44-a88cbed79aeb'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''ScreeningCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''35c62034-5b20-5891-8d38-3e9b051dec6e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''INGESTED_CSV'', ''ATTEMPT_CSV_ASSURANCE'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX_CODE'' AS issue_column,\n           \"ADMINISTRATIVE_SEX_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX_CODE\" NOT IN (''M'', ''F'', ''X (UN)'', ''UNK'', ''OTH. ASKU'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''X (UN)'''', ''''UNK'''', ''''OTH. ASKU'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE\" NOT IN (''M'', ''F'', ''ASKU'', ''OTH'', ''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''')'',\n           ''Use only allowed values ''''M'''', ''''F'''', ''''ASKU'''', ''''OTH'''', ''''UNK'''' in '' || issue_column\n      FROM allowed_values; \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH_CODE_DESCRIPTION'' AS issue_column,\n           \"SEX_AT_BIRTH_CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEX_AT_BIRTH_CODE_DESCRIPTION\" NOT IN (''Male'', ''Female'', ''Asked but Unknown'', ''Other'', ''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''', ''''Female'''', ''''Asked but Unknown'''', ''''Other'''', ''''Unknown'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX _CODE_DESCRIPTION'' AS issue_column,\n           \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ADMINISTRATIVE_SEX _CODE_DESCRIPTION\" NOT IN (''Male'',''Female'',''Asked but Unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Male'''',''''Female'''',''''Asked but Unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_ID'' AS issue_column,\n           \"FACILITY_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"FACILITY_ID\" IS NULL\n        OR TRIM(\"FACILITY_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" IS NULL\n        OR TRIM(\"CONSENT\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT'' AS issue_column,\n           \"CONSENT\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"demographic_data_2_01hpkty3hctk826tvx5tasga55\"\n     WHERE \"CONSENT\" NOT IN (''Yes'',''No'',''Y'',''N'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''80af4eff-d697-565b-9e3f-a587e322b1da'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''Y'''',''''N'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''3cab2329-2aae-5475-9792-04e14e862f1e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''80af4eff-d697-565b-9e3f-a587e322b1da'', ''ATTEMPT_CSV_ASSURANCE'', ''ASSURED_CSV'', NULL, ''AdminDemographicCsvFileIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''aa8b8d1a-c8cc-5a9b-b5aa-34a6fc85e11a'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" IS NULL\n        OR TRIM(\"FIRST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FIRST_NAME'' AS issue_column,\n           \"FIRST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FIRST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''MIDDLE_NAME'' AS issue_column,\n           \"MIDDLE_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MIDDLE_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" IS NULL\n        OR TRIM(\"LAST_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''LAST_NAME'' AS issue_column,\n           \"LAST_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"LAST_NAME\" NOT SIMILAR TO ''^[A-Za-z]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]+$'',\n           ''Follow the pattern ^[A-Za-z]+$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" IS NULL\n        OR TRIM(\"ADMINISTRATIVE_SEX\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''ADMINISTRATIVE_SEX'' AS issue_column,\n           \"ADMINISTRATIVE_SEX\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADMINISTRATIVE_SEX\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values;   \nWITH allowed_values AS (\n    SELECT ''SEX_AT_BIRTH'' AS issue_column,\n           \"SEX_AT_BIRTH\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEX_AT_BIRTH\" NOT IN (''M'',''F'',''X'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''M'''',''''F'''',''''X'''')'',\n           ''Use only allowed values ''''M'''',''''F'''',''''X'''' in '' || issue_column\n      FROM allowed_values; \nWITH mandatory_value AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NULL\n        OR TRIM(\"PAT_BIRTH_DATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH valid_birth_date_in_all_rows AS (\n    SELECT ''PAT_BIRTH_DATE'' AS issue_column,\n           \"PAT_BIRTH_DATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_BIRTH_DATE\" IS NOT NULL\n       AND TRY_CAST(\"PAT_BIRTH_DATE\" AS DATE) IS NULL\n       AND EXTRACT(YEAR FROM TRY_CAST(\"PAT_BIRTH_DATE\" AS TIMESTAMP)) < 1915\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Birth Date \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Provide a valid birthdate on or after 1915.''\n      FROM valid_birth_date_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''CITY'' AS issue_column,\n           \"CITY\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CITY\" IS NULL\n        OR TRIM(\"CITY\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" IS NULL\n        OR TRIM(\"STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''STATE'' AS issue_column,\n           \"STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" IS NULL\n        OR TRIM(\"ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''ZIP'' AS issue_column,\n           \"ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH pattern AS (\n    SELECT ''ADDRESS1'' AS issue_column,\n           \"ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE'' AS issue_column,\n           \"GENDER_IDENTITY_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE\" NOT IN (''407377005'',''446141000124107'',''446151000124109'',''446131000124102'',''407376001'',''ASKU'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''407377005'''',''''446141000124107'''',''''446151000124109'''',''''446131000124102'''',''''407376001'''',''''ASKU'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_DESCRIPTION'' AS issue_column,\n           \"GENDER_IDENTITY_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_DESCRIPTION\" NOT IN (''Female-to-Male (FTM)'',''Transgender Male'',''Trans Man'',''Female'',''Male'',''Genderqueer'',''Male-to-Female (MTF)'', ''Transgender Female'',''Trans Woman'',''Asked but unknown'',''Other'',''Unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''')'',\n           ''Use only allowed values ''''Female-to-Male (FTM)'''',''''Transgender Male'''',''''Trans Man'''',''''Female'''',''''Male'''',''''Genderqueer'''',''''Male-to-Female (MTF)'''', ''''Transgender Female'''',''''Trans Woman'''',''''Asked but unknown'''',''''Other'''',''''Unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''GENDER_IDENTITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"GENDER_IDENTITY_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE\" NOT IN (''42035005'',''20430005'',''38628009'',''OTH'',''UNK'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''')'',\n           ''Use only allowed values ''''42035005'''',''''20430005'''',''''38628009'''',''''OTH'''',''''UNK'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_CODE_SYSTEM_NAME\" NOT IN (''SNOMED-CT'',''SNOMED'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''SNOMED-CT'''',''''SNOMED'''')'',\n           ''Use only allowed values ''''SNOMED-CT'''',''''SNOMED'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''SEXUAL_ORIENTATION_DESCRIPTION'' AS issue_column,\n           \"SEXUAL_ORIENTATION_DESCRIPTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"SEXUAL_ORIENTATION_DESCRIPTION\" NOT IN (''Bisexual'',''Straight'',''Gay or lesbian'',''other'',''unknown'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''')'',\n           ''Use only allowed values ''''Bisexual'''',''''Straight'''',''''Gay or lesbian'''',''''other'''',''''unknown'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''RACE_CODE_SYSTEM_NAME'' AS issue_column,\n           \"RACE_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"RACE_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ETHNICITY_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ETHNICITY_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"ETHNICITY_CODE_SYSTEM_NAME\" NOT IN (''CDC'',''CDCRE'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''CDC'''',''''CDCRE'''')'',\n           ''Use only allowed values ''''CDC'''',''''CDCRE'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''MPI_ID'' AS issue_column,\n           \"MPI_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MPI_ID\" IS NULL\n        OR TRIM(\"MPI_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;   \nWITH pattern AS (\n    SELECT ''MEDICAID_CIN'' AS issue_column,\n           \"MEDICAID_CIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"MEDICAID_CIN\" NOT SIMILAR TO ''^[A-Za-z]{2}\\d{5}[A-Za-z]$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$'',\n           ''Follow the pattern ^[A-Za-z]{2}\\d{5}[A-Za-z]$ in '' || issue_column\n      FROM pattern; \nWITH mandatory_value AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" IS NULL\n        OR TRIM(\"CONSENT \") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH allowed_values AS (\n    SELECT ''CONSENT '' AS issue_column,\n           \"CONSENT \" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_admin_demographic\"\n     WHERE \"CONSENT \" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''5b77d127-e62a-50a9-acee-bea63ff64dd5'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''b63bd83d-959a-5a5f-8d60-08b84bf16c90'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''5b77d127-e62a-50a9-acee-bea63ff64dd5'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AdminDemographicExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''8278fd0f-7116-55bd-8d7a-0a30681b0d2f'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_NAME'' AS issue_column,\n           \"SCREENING_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_NAME\" IS NULL\n        OR TRIM(\"SCREENING_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"SCREENING_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_CODE_SYSTEM_NAME'' AS issue_column,\n           \"SCREENING_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE_SYSTEM_NAME\" NOT IN (''LN'', ''LOINC'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''', ''''LOINC'''')'',\n           ''Use only allowed values ''''LN'''', ''''LOINC'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SCREENING_CODE'' AS issue_column,\n           \"SCREENING_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_CODE\" IS NULL\n        OR TRIM(\"SCREENING_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''SCREENING_METHOD'' AS issue_column,\n           \"SCREENING_METHOD\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SCREENING_METHOD\" NOT IN (''In-Person'', ''Phone'', ''Website'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''In-Person'''', ''''Phone'''', ''''Website'''')'',\n           ''Use only allowed values ''''In-Person'''', ''''Phone'''', ''''Website'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NULL\n        OR TRIM(\"RECORDED_TIME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value; \nWITH valid_date_time_in_all_rows AS (\n    SELECT ''RECORDED_TIME'' AS issue_column,\n           \"RECORDED_TIME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"RECORDED_TIME\" IS NOT NULL\n       AND TRY_CAST(\"RECORDED_TIME\" AS TIMESTAMP) IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Date'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid timestamp \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Please be sure to provide both a valid date and time.''\n      FROM valid_date_time_in_all_rows;\nWITH mandatory_value AS (\n    SELECT ''QUESTION'' AS issue_column,\n           \"QUESTION\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION\" IS NULL\n        OR TRIM(\"QUESTION\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''MEAS_VALUE'' AS issue_column,\n           \"MEAS_VALUE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"MEAS_VALUE\" IS NULL\n        OR TRIM(\"MEAS_VALUE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;      \nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           \"QUESTION_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE\" IS NULL\n        OR TRIM(\"QUESTION_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"QUESTION_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''QUESTION_CODE_SYSTEM_NAME'' AS issue_column,\n           \"QUESTION_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"QUESTION_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE'' AS issue_column,\n           \"ANSWER_CODE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE\" IS NULL\n        OR TRIM(\"ANSWER_CODE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" IS NULL\n        OR TRIM(\"ANSWER_CODE_SYSTEM_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ANSWER_CODE_SYSTEM_NAME'' AS issue_column,\n           \"ANSWER_CODE_SYSTEM_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ANSWER_CODE_SYSTEM_NAME\" NOT IN (''LN'',''LOIN'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''LN'''',''''LOIN'''')'',\n           ''Use only allowed values ''''LN'''',''''LOIN'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''SDOH_DOMAIN'' AS issue_column,\n           \"SDOH_DOMAIN\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"SDOH_DOMAIN\" IS NULL\n        OR TRIM(\"SDOH_DOMAIN\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" IS NULL\n        OR TRIM(\"POTENTIAL_NEED_INDICATED\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''POTENTIAL_NEED_INDICATED'' AS issue_column,\n           \"POTENTIAL_NEED_INDICATED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"POTENTIAL_NEED_INDICATED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH allowed_values AS (\n    SELECT ''ASSISTANCE_REQUESTED'' AS issue_column,\n           \"ASSISTANCE_REQUESTED\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_screening\"\n     WHERE \"ASSISTANCE_REQUESTED\" NOT IN (''Yes'',''No'',''NA'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''',''''No'''',''''NA'''')'',\n           ''Use only allowed values ''''Yes'''',''''No'''',''''NA'''' in '' || issue_column\n      FROM allowed_values;\nWITH valid_screening_questions_in_all_rows AS (\n    SELECT ''QUESTION_CODE'' AS issue_column,\n           sr.\"QUESTION_CODE\" AS invalid_value,\n           sr.src_file_row_number AS issue_row\n      FROM ahc_hrsn_2024_01_25_valid_screening sr\n      LEFT JOIN ahc_hrsn_2024_01_25_valid_question_reference qr\n      ON sr.QUESTION_CODE = qr.QUESTION_CODE AND sr.SCREENING_CODE = qr.SCREENING_CODE            \n     WHERE sr.QUESTION_CODE IS NOT NULL\n      AND qr.QUESTION_CODE IS NULL\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'',\n           ''Invalid Screening Question'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Invalid Screening Question \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Validate screening questions with question reference data''\n      FROM valid_screening_questions_in_all_rows;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''47d97ff4-908a-50f7-a2e2-443e2dad7056'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''21d7e4ec-32e3-5e20-9029-28fdd6c5fa66'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''ScreeningExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''c420c3ba-ddbc-582b-9cdf-361497beb034'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n\nWITH mandatory_value AS (\n    SELECT ''PAT_MRN_ID'' AS issue_column,\n           \"PAT_MRN_ID\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"PAT_MRN_ID\" IS NULL\n        OR TRIM(\"PAT_MRN_ID\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NULL\n        OR TRIM(\"FACILITY ID (Assigning authority)\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ID (Assigning authority)'' AS issue_column,\n           \"FACILITY ID (Assigning authority)\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ID (Assigning authority)\" IS NOT NULL\n       AND \"FACILITY ID (Assigning authority)\" IN (\n          SELECT \"FACILITY ID (Assigning authority)\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ID (Assigning authority)\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH mandatory_value AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" IS NULL\n        OR TRIM(\"FACILITY_LONG_NAME\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH mandatory_value AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" IS NULL\n        OR TRIM(\"ORGANIZATION_TYPE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''ORGANIZATION_TYPE'' AS issue_column,\n           \"ORGANIZATION_TYPE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"ORGANIZATION_TYPE\" NOT IN (''Hospital'', ''DTC'', ''SNF'', ''SCN'', ''CBO'', ''OMH'', ''OASAS'', ''Practice'', ''Article 36'', ''Article 40'', ''MCO'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''')'',\n           ''Use only allowed values ''''Hospital'''', ''''DTC'''', ''''SNF'''', ''''SCN'''', ''''CBO'''', ''''OMH'''', ''''OASAS'''', ''''Practice'''', ''''Article 36'''', ''''Article 40'''', ''''MCO'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NULL\n        OR TRIM(\"FACILITY ADDRESS1\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" IS NOT NULL\n       AND \"FACILITY ADDRESS1\" IN (\n          SELECT \"FACILITY ADDRESS1\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS1\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;   \nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS1'' AS issue_column,\n           \"FACILITY ADDRESS1\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS1\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern; \nWITH unique_value AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" IS NOT NULL\n       AND \"FACILITY ADDRESS2\" IN (\n          SELECT \"FACILITY ADDRESS2\"\n            FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n        GROUP BY \"FACILITY ADDRESS2\"\n          HAVING COUNT(*) > 1)\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Unique Value Violation'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Duplicate value \"'' || invalid_value || ''\" found in '' || issue_column,\n           ''Ensure each value in column6 is unique''\n      FROM unique_value;\nWITH pattern AS (\n    SELECT ''FACILITY ADDRESS2'' AS issue_column,\n           \"FACILITY ADDRESS2\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ADDRESS2\" NOT SIMILAR TO ''^[a-zA-Z0-9\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z0-9\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z0-9\\s]+$ in '' || issue_column\n      FROM pattern;    \nWITH mandatory_value AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" IS NULL\n        OR TRIM(\"FACILITY STATE\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''FACILITY STATE'' AS issue_column,\n           \"FACILITY STATE\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY STATE\" NOT IN (''NY'', ''New York'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''NY'''', ''''New York'''')'',\n           ''Use only allowed values ''''NY'''', ''''New York'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" IS NULL\n        OR TRIM(\"FACILITY ZIP\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH pattern AS (\n    SELECT ''FACILITY ZIP'' AS issue_column,\n           \"FACILITY ZIP\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY ZIP\" NOT SIMILAR TO ''^\\d{5}(\\d{4})?$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^\\d{5}(\\d{4})?$'',\n           ''Follow the pattern ^\\d{5}(\\d{4})?$ in '' || issue_column\n      FROM pattern;\nWITH mandatory_value AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" IS NULL\n        OR TRIM(\"VISIT_PART_2_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_PART_2_FLAG'' AS issue_column,\n           \"VISIT_PART_2_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_PART_2_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OMH_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OMH_FLAG'' AS issue_column,\n           \"VISIT_OMH_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OMH_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH mandatory_value AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" IS NULL\n        OR TRIM(\"VISIT_OPWDD_FLAG\") = ''''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Missing Mandatory Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Mandatory field '' || issue_column || '' is empty'',\n           ''Provide a value for '' || issue_column\n      FROM mandatory_value;\nWITH allowed_values AS (\n    SELECT ''VISIT_OPWDD_FLAG'' AS issue_column,\n           \"VISIT_OPWDD_FLAG\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"VISIT_OPWDD_FLAG\" NOT IN (''Yes'', ''No'')\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Invalid Value'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' not in allowed list (''''Yes'''', ''''No'''')'',\n           ''Use only allowed values ''''Yes'''', ''''No'''' in '' || issue_column\n      FROM allowed_values;\nWITH pattern AS (\n    SELECT ''FACILITY_LONG_NAME'' AS issue_column,\n           \"FACILITY_LONG_NAME\" AS invalid_value,\n           src_file_row_number AS issue_row\n      FROM \"ahc_hrsn_2024_01_25_valid_q_e_admin_data\"\n     WHERE \"FACILITY_LONG_NAME\" NOT SIMILAR TO ''^[a-zA-Z\\s]+$''\n)\nINSERT INTO orch_session_issue (orch_session_issue_id, session_id, session_entry_id, issue_type, issue_row, issue_column, invalid_value, issue_message, remediation)\n    SELECT uuid(),\n           ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'',\n           ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'',\n           ''Pattern Mismatch'',\n           issue_row,\n           issue_column,\n           invalid_value,\n           ''Value '' || invalid_value || '' in '' || issue_column || '' does not match the pattern ^[a-zA-Z\\s]+$'',\n           ''Follow the pattern ^[a-zA-Z\\s]+$ in '' || issue_column\n      FROM pattern;\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''90a0010e-213e-58c3-9302-5e7310006b95'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''f6d4aff4-4b71-5662-8f57-00ee247dc57c'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QeAdminDataExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''97c2cca2-92f5-5937-97e6-d84beeb4018e'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''f626602e-8be5-5e8c-824c-bdde91b22817'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''657d6337-8d24-5b67-b139-87db6a228264'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''QuestionReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''442b5e69-76fb-5da8-ae00-b79ea50cbedb'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''INGESTED_EXCEL_WORKBOOK_SHEET'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n                \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES (''398104b8-02dc-509b-998a-0b66b5a912e1'', ''05269d28-15ae-5bd6-bd88-f949ccfa52d7'', ''e2816d61-4406-5073-ac60-f129a107d938'', ''ATTEMPT_EXCEL_WORKBOOK_SHEET_ASSURANCE'', ''ASSURED_EXCEL_WORKBOOK_SHEET'', NULL, ''AnswerReferenceExcelSheetIngestSource.assuranceSQL'', (CURRENT_TIMESTAMP), NULL);\n    \n```\nNo STDOUT emitted by `ensureContent` (status: `0`).\n\nNo STDERR emitted by `ensureContent`.\n\n    ', NULL);;\n-- diagnostics-md-ignore-finish \"SQLPage and execution diagnostics SQL DML\"\n\nATTACH '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('334b7ece-79ec-5ea1-b98b-bb09d0e2b234', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM qe_admin_data_2_01hpkty3hctk826tvx5tasga55;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('397748ba-bd27-56b6-8272-a45f9caeaf64', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0626c65d-bfe1-5eba-8a88-316343d5a123', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.screening_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM screening_2_01hpkty3hctk826tvx5tasga55;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_2_01hpkty3hctk826tvx5tasga55;\n  \n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir_questionnaire AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID \n        ),\n        'authored', RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', QUESTION_CODE,\n                'text', QUESTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', ANSWER_CODE,\n                        'display', MEAS_VALUE\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_2_01hpkty3hctk826tvx5tasga55; \n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('485754a8-39a0-5f12-96bc-6e869590e1e9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6ec2d7d4-0366-56b5-8763-dd9d6361dce0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM demographic_data_2_01hpkty3hctk826tvx5tasga55;\n  \nCREATE VIEW resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55_fhir_patient AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Patient',\n        'identifier', MPI_ID,\n        'active', true,\n        'name', CONCAT(FIRST_NAME,' ', LAST_NAME),\n        'telecom', '',\n        'gender', GENDER_IDENTITY_DESCRIPTION,\n        'birthDate', PAT_BIRTH_DATE,\n        'address', json_array(\n            json_object(\n              'text', ADDRESS1,\n              'line', ADDRESS2,\n              'city', CITY,\n              'state', STATE,\n              'postalCode', ZIP\n          )\n        )\n    ) AS FHIR_Patient\n  FROM demographic_data_2_01hpkty3hctk826tvx5tasga55; \n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('09b84d82-4502-5597-99c1-a190fb056033', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63d56427-0888-5164-bea5-3f122e5805fd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_admin_demographic AS SELECT * FROM ahc_hrsn_2024_01_25_valid_admin_demographic;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1a02c252-e9e3-5a86-8ec9-54e0cb66e62b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2d193f6b-b33f-5f8b-8281-da48e6bceaaf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_screening AS SELECT * FROM ahc_hrsn_2024_01_25_valid_screening;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3392e5a3-5c3e-5fbe-9dc0-08c6b4a4cc99', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d8ecb6e-190a-5c47-b730-41cbb9d35145', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_q_e_admin_data AS SELECT * FROM ahc_hrsn_2024_01_25_valid_q_e_admin_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7b09fc-4ad4-5311-92d1-7c7a0550d0aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('effcdab8-9c23-5403-ac83-f79f6f89b302', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_question_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_question_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ddd5157b-0daf-5a61-bcd3-cda46ece2d09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(QuestionReferenceExcelSheetIngestSource)', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7210b304-8af5-537d-be03-2b8bb421337d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_answer_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_answer_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('841b1d15-81a7-5865-8dee-86f56e93ad92', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AnswerReferenceExcelSheetIngestSource)', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    ;\n\n-- export reference tables from DuckDb into the attached database (nature-dependent)\nCREATE TABLE resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference;\nCREATE TABLE resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference;\nCREATE TABLE resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference;\nCREATE TABLE resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference;\nCREATE TABLE resource_db.business_rules AS SELECT * FROM business_rules;\nCREATE TABLE resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## emitResources\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('05e8feaa-0bed-5909-a817-39812494b361', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'NONE', 'ENTER(prepareInit)', NULL, 'rsEE.beforeCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('8f460419-7b80-516d-8919-84520950f612', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(prepareInit)', 'ENTER(init)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1931dfcc-e8fc-597d-b1bc-65b4287e6fdf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(init)', 'ENTER(ingest)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('17cedd6e-e794-5b45-9790-c4ba2483cc1e', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ingest)', 'ENTER(ensureContent)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0a26bdb9-1499-515c-aeb4-c6d1d0a20541', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', NULL, 'EXIT(ensureContent)', 'ENTER(emitResources)', NULL, 'rsEE.afterCell', ('2024-02-16T16:13:33.202Z'), NULL);\n\n-- removed SQLPage and execution diagnostics SQL DML from diagnostics Markdown\n\nATTACH '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/resource.sqlite.db' AS resource_db (TYPE SQLITE);\n\n-- copy relevant orchestration engine admin tables into the the attached database\nCREATE TABLE resource_db.device AS SELECT * FROM device;\nCREATE TABLE resource_db.orch_session AS SELECT * FROM orch_session;\nCREATE TABLE resource_db.orch_session_entry AS SELECT * FROM orch_session_entry;\nCREATE TABLE resource_db.orch_session_state AS SELECT * FROM orch_session_state;\nCREATE TABLE resource_db.orch_session_exec AS SELECT * FROM orch_session_exec;\nCREATE TABLE resource_db.orch_session_issue AS SELECT * FROM orch_session_issue;\nCREATE TABLE resource_db.sqlpage_files AS SELECT * FROM sqlpage_files;\n\n-- export content tables from DuckDb into the attached database (nature-dependent)\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('334b7ece-79ec-5ea1-b98b-bb09d0e2b234', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ASSURED_CSV', 'EXIT(QeAdminDataCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.qe_admin_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM qe_admin_data_2_01hpkty3hctk826tvx5tasga55;\n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('397748ba-bd27-56b6-8272-a45f9caeaf64', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '7ef8bdeb-fd56-5eb9-a09b-ef15ce18dc49', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'QeAdminDataCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('0626c65d-bfe1-5eba-8a88-316343d5a123', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ASSURED_CSV', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.screening_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM screening_2_01hpkty3hctk826tvx5tasga55;\n\n-- try sqltofhir Visual Studio Code extension for writing FHIR resources with SQL.\n-- see https://marketplace.visualstudio.com/items?itemName=arkhn.sqltofhir-vscode\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Observation',\n        'id', ENCOUNTER_ID,\n        'status', 'final',\n        'code', json_object(\n            'coding', json_array(\n                json_object(\n                    'system', QUESTION_CODE_SYSTEM_NAME,\n                    'code', QUESTION_CODE,\n                    'display', QUESTION\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'effectiveDateTime', RECORDED_TIME,\n        'valueString', MEAS_VALUE,\n        'performer', json_array(\n            json_object(\n                'reference', 'Practitioner/' || session_id\n            )\n        ),\n        'context', json_object(\n            'reference', 'Encounter/' || ENCOUNTER_ID\n        )\n    ) AS FHIR_Observation\n  FROM screening_2_01hpkty3hctk826tvx5tasga55;\n  \n        -- TODO: Need to fill out subject->display, source->display, questionnaire\nCREATE VIEW resource_db.screening_2_01hpkty3hctk826tvx5tasga55_fhir_questionnaire AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'QuestionnaireResponse',\n        'id', ENCOUNTER_ID,\n        'status', 'completed',\n        'questionnaire', '',\n        '_questionnaire', json_object(\n            'extension', json_array(\n                json_object(\n                    'url', QUESTION_CODE_SYSTEM_NAME,\n                    'valueString', QUESTION_CODE\n                )\n            )\n        ),\n        'subject', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID \n        ),\n        'authored', RECORDED_TIME,\n        'source', json_object(\n            'reference', 'Patient/' || PAT_MRN_ID\n        ),\n        'item', json_array(\n            json_object(\n                'linkId', QUESTION_CODE,\n                'text', QUESTION,\n                'answer',  json_array(\n                  json_object(\n                      'valueCoding', json_object(\n                        'system', 'http://loinc.org',\n                        'code', ANSWER_CODE,\n                        'display', MEAS_VALUE\n                      )\n                  )\n                )\n            )\n        )\n    ) AS FHIR_Questionnaire\n  FROM screening_2_01hpkty3hctk826tvx5tasga55; \n\n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('485754a8-39a0-5f12-96bc-6e869590e1e9', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '0e074bf2-f1fe-55d4-bd44-a88cbed79aeb', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'ScreeningCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('6ec2d7d4-0366-56b5-8763-dd9d6361dce0', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ASSURED_CSV', 'EXIT(AdminDemographicCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55 AS SELECT * FROM demographic_data_2_01hpkty3hctk826tvx5tasga55;\n  \nCREATE VIEW resource_db.demographic_data_2_01hpkty3hctk826tvx5tasga55_fhir_patient AS \n  SELECT pat_mrn_id, json_object(\n        'resourceType', 'Patient',\n        'identifier', MPI_ID,\n        'active', true,\n        'name', CONCAT(FIRST_NAME,' ', LAST_NAME),\n        'telecom', '',\n        'gender', GENDER_IDENTITY_DESCRIPTION,\n        'birthDate', PAT_BIRTH_DATE,\n        'address', json_array(\n            json_object(\n              'text', ADDRESS1,\n              'line', ADDRESS2,\n              'city', CITY,\n              'state', STATE,\n              'postalCode', ZIP\n          )\n        )\n    ) AS FHIR_Patient\n  FROM demographic_data_2_01hpkty3hctk826tvx5tasga55; \n  \n  INSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('09b84d82-4502-5597-99c1-a190fb056033', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '80af4eff-d697-565b-9e3f-a587e322b1da', 'ATTEMPT_CSV_EXPORT', 'EXIT(ScreeningCsvFileIngestSource)', NULL, 'AdminDemographicCsvFileIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n  \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('63d56427-0888-5164-bea5-3f122e5805fd', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_admin_demographic AS SELECT * FROM ahc_hrsn_2024_01_25_valid_admin_demographic;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('1a02c252-e9e3-5a86-8ec9-54e0cb66e62b', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '5b77d127-e62a-50a9-acee-bea63ff64dd5', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'AdminDemographicExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('2d193f6b-b33f-5f8b-8281-da48e6bceaaf', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_screening AS SELECT * FROM ahc_hrsn_2024_01_25_valid_screening;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('3392e5a3-5c3e-5fbe-9dc0-08c6b4a4cc99', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '21d7e4ec-32e3-5e20-9029-28fdd6c5fa66', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(ScreeningExcelSheetIngestSource)', NULL, 'ScreeningExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7d8ecb6e-190a-5c47-b730-41cbb9d35145', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_q_e_admin_data AS SELECT * FROM ahc_hrsn_2024_01_25_valid_q_e_admin_data;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('4b7b09fc-4ad4-5311-92d1-7c7a0550d0aa', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'f6d4aff4-4b71-5662-8f57-00ee247dc57c', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AdminDemographicExcelSheetIngestSource)', NULL, 'QeAdminDataExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('effcdab8-9c23-5403-ac83-f79f6f89b302', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_question_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_question_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('ddd5157b-0daf-5a61-bcd3-cda46ece2d09', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', '657d6337-8d24-5b67-b139-87db6a228264', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(QuestionReferenceExcelSheetIngestSource)', NULL, 'QuestionReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    \nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('7210b304-8af5-537d-be03-2b8bb421337d', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ASSURED_EXCEL_WORKBOOK_SHEET', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n\nCREATE TABLE resource_db.ahc_hrsn_2024_01_25_valid_answer_reference AS SELECT * FROM ahc_hrsn_2024_01_25_valid_answer_reference;\n\nINSERT INTO \"orch_session_state\" (\"orch_session_state_id\", \"session_id\", \"session_entry_id\", \"from_state\", \"to_state\", \"transition_result\", \"transition_reason\", \"transitioned_at\", \"elaboration\") VALUES ('841b1d15-81a7-5865-8dee-86f56e93ad92', '05269d28-15ae-5bd6-bd88-f949ccfa52d7', 'e2816d61-4406-5073-ac60-f129a107d938', 'ATTEMPT_EXCEL_WORKBOOK_SHEET_EXPORT', 'EXIT(AnswerReferenceExcelSheetIngestSource)', NULL, 'AnswerReferenceExcelSheetIngestSource.exportResourceSQL', (CURRENT_TIMESTAMP), NULL);\n    ;\n\n-- export reference tables from DuckDb into the attached database (nature-dependent)\nCREATE TABLE resource_db.encounter_class_reference AS SELECT * FROM encounter_class_reference;\nCREATE TABLE resource_db.screening_status_code_reference AS SELECT * FROM screening_status_code_reference;\nCREATE TABLE resource_db.encounter_status_code_reference AS SELECT * FROM encounter_status_code_reference;\nCREATE TABLE resource_db.encounter_type_code_reference AS SELECT * FROM encounter_type_code_reference;\nCREATE TABLE resource_db.business_rules AS SELECT * FROM business_rules;\nCREATE TABLE resource_db.ahc_cross_walk AS SELECT * FROM ahc_cross_walk;\n\nDETACH DATABASE resource_db;\n\n-- no after-finalize SQL provided\n```\nNo STDOUT emitted by `emitResources` (status: `0`).\n\nNo STDERR emitted by `emitResources`.\n\n    "
      }
    },
    {
      "insertable": {
        "exec_identity": "emitDiagnostics",
        "exec_code": "duckdb /home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/ingestion-center.duckdb",
        "sql": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "orch_session_exec_id": "11b19c60-a371-5444-9831-cb06a48b442e",
        "exec_nature": "duckdb",
        "exec_status": 0,
        "input_text": "-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');",
        "session_id": "05269d28-15ae-5bd6-bd88-f949ccfa52d7",
        "narrative_md": "\n## emitDiagnostics\n\n```sql\n-- preambleSQL\nSET autoinstall_known_extensions=true;\nSET autoload_known_extensions=true;\n-- end preambleSQL\nINSTALL spatial; LOAD spatial;\n-- TODO: join with orch_session table to give all the results in one sheet\nCOPY (SELECT * FROM orch_session_diagnostic_text) TO '/home/snshah/workspaces/github.com/qe-collaborative-services/1115-hub/support/assurance/ahc-hrsn-elt/screening/results-test-e2e/diagnostics.xlsx' WITH (FORMAT GDAL, DRIVER 'xlsx');\n```\nNo STDOUT emitted by `emitDiagnostics` (status: `0`).\n\nNo STDERR emitted by `emitDiagnostics`.\n\n    "
      }
    }
  ]
}